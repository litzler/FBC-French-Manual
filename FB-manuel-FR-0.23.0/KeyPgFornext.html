<html>
<head>
<title>For...Next</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">For...Next</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	D&eacute;claration de contr&ocirc;le de flux pour boucler<br \>
<br \>
<div class="fb_sect_title">Syntaxe</div><div class="fb_sect_cont"><tt><br \>
<b>For</b> <i>iterator</i> [ <a href="KeyPgAs.html">As</a> <a href="DataType.html">datatype</a> ] = <i>startvalue</i> <b>To</b> <i>endvalue</i> [ <b>Step</b> <i>stepvalue</i> ]<br \>
<div class="fb_indent">[ <i>statement block</i> ]<br \>
</div><b>Next</b> [ <i>iterator</i> ]<br \>
</tt><br \>
</div><div class="fb_sect_title">Param&egrave;tres</div><div class="fb_sect_cont"><br \>
<tt><i>iterator</i></tt><br \>
<div class="fb_indent">Une variable qui est utilis&eacute;e pour effectuer une it&eacute;ration d'une valeur initiale &agrave; une valeur finale<br \>
</div><tt><i>datatype</i></tt><br \>
<div class="fb_indent">Si sp&eacute;cifi&eacute;e, la variable <tt><i>iterator</i></tt> sera automatiquement d&eacute;clar&eacute;e avec le type <tt><i>datatype</i></tt>.<br \>
</div><tt><i>startvalue</i></tt><br \>
<div class="fb_indent">Une expression qui d&eacute;signe la valeur de d&eacute;part de l'it&eacute;rateur<br \>
</div><tt><i>endvalue</i></tt><br \>
<div class="fb_indent">Une expression utilis&eacute;e pour comparer avec la valeur de l'it&eacute;rateur<br \>
</div><tt><i>stepvalue</i></tt><br \>
<div class="fb_indent">Une expression qui est ajout&eacute;e &agrave; l'it&eacute;rateur apr&egrave;s chaque it&eacute;ration<br \>
<br \>
</div></div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
Une boucle <tt><b>For...Next</b></tt> initialise l'<tt><i>iterator</i></tt> avec <tt><i>startvalue</i></tt>, puis &eacute;x&eacute;cute le <tt><i>statement block = bloc d'instructions</i></tt>, incr&eacute;mente <tt><i>iterator</i></tt> de <tt><i>stepvalue</i></tt> jusqu'&agrave; ce qu'il atteigne <tt><i>endvalue</i></tt>. Si <tt><i>stepvalue</i></tt> n'est pas pr&eacute;cis&eacute; explicitement il sera fix&eacute; &agrave; 1.<br \>
<br \>
Les valeurs de <tt><i>stepvalue</i></tt> et <tt><i>endvalue</i></tt> sont stock&eacute;es en interne imm&eacute;diatement apr&egrave;s l'ex&eacute;cution de l'instruction <tt><b>For</b></tt> et donc aucune ne peut &ecirc;tre chang&eacute;e &agrave; l'int&eacute;rieur de la boucle <tt><b>For</b></tt>. (les variables qui les d&eacute;finissent peuvent &ecirc;tre chang&eacute;es, mais en changeant ces variables &agrave; l'int&eacute;rieur de la boucle <tt><b>For</b></tt> n'affectera pas son ex&eacute;cution. (Voir les exemples)<br \>
<br \>
L' <tt><i>iterator</i></tt> peut &ecirc;tre d&eacute;fini en ayant la m&ecirc;me port&eacute;e que la d&eacute;claration <tt><b>For</b></tt> en utilisant la syntaxe de <tt><a href="KeyPgAs.html">As</a> <a href="DataType.html">datatype</a></tt>. Avec cette syntaxe, <i>iterator</i> est cr&eacute;&eacute; et d&eacute;truit dans la port&eacute;e de <tt><b>For...Next</b></tt>. Voir diff&eacute;rences de dialecte ci-dessous.<br \>
<br \>
Si <tt><i>endvalue</i></tt> est inf&eacute;rieure &agrave; <tt><i>startvalue</i></tt> alors une <tt><i>stepvalue</i></tt> n&eacute;gative doit &ecirc;tre pr&eacute;cis&eacute;e ou le <tt><i>statement block</i></tt> ne s'ex&eacute;cutera pas du tout, puisque <tt><i>startvalue</i></tt> est d&eacute;j&agrave; sup&eacute;rieure &agrave; <tt><i>endvalue</i></tt>.<br \>
<br \>
La d&eacute;claration <tt><b>For</b></tt> provoque l'ex&eacute;cution des instructions du <tt><i>statement block</i></tt> tant qu'est effectu&eacute;e la comparaison <tt><i>iterator</i></tt> <b>plus grand que</b> <tt><i>endvalue</i></tt> (ou <b>plus petit que</b> <tt><i>endvalue</i></tt> si <tt><i>stepvalue</i> &lt; 0</tt>). <tt><i>iterator</i></tt> sera increment&eacute; de la valeur de <tt><i>stepvalue</i></tt> apr&egrave;s chaque ex&eacute;cution du <tt><i>statement block</i></tt>. Si Aucun incr&eacute;ment n'est donn&eacute;, <tt><i>iterator</i></tt> sera implicitement increment&eacute; de <tt>1</tt>.<br \>
<br \>
Si un <tt><a href="KeyPgExit.html">Exit</a></tt> <tt><b>For</b></tt> est rencontr&eacute; dans le <tt><i>statement block</i></tt>, la boucle se termine et l'ex&eacute;cution reprend imm&eacute;diatement apr&egrave;s la d&eacute;claration suivant <tt><b>Next</b></tt>. Si <tt><a href="KeyPgContinue.html">Continue</a></tt> <tt><b>For</b></tt> est rencontr&eacute;, le reste du <tt><i>statement block</i></tt> est saut&eacute; et l'ex&eacute;cution reprend &agrave; la d&eacute;claration FOR.<br \>
<br \>
Comme toutes les d&eacute;clarations de contr&ocirc;le de flux, <tt><b>For</b></tt> peut &ecirc;tre imbriqu&eacute;, ce qui signifie qu'il peut &ecirc;tre utilis&eacute; dans un bloc d'instructions d'une autre d&eacute;claration <tt><b>For</b></tt>.<br \>
<br \>
<b>Note</b>: Quand <tt><i>stepvalue</i></tt> est n&eacute;gatif, <tt><b>For</b></tt> boucle tant qu'est effectu&eacute;e la comparaison <tt><i>iterator</i></tt> <i>plus petit que</i> <tt><i>end_value</i></tt>.<br \>
<br \>
<tt><i>For</i></tt>, <tt><i>Next</i></tt> et <tt><i>Step</i></tt> sont des op&eacute;rateurs qui peuvent &ecirc;tre surcharg&eacute;s dans des types d&eacute;finis par l'utilisateur. Voir <a href="KeyPgOpFor.html">Op&eacute;rateur For</a>, <a href="KeyPgOpNext.html">Op&eacute;rateur Next</a>, <a href="KeyPgOpStep.html">Op&eacute;rateur</a><br \>
<br \>
</div><div class="fb_sect_title">Exemple</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="key">Dim</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Single</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">"counting&nbsp;from&nbsp;3&nbsp;to&nbsp;0,&nbsp;with&nbsp;a&nbsp;step&nbsp;of&nbsp;-0.5"</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Single</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">3</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Step</span>&nbsp;<span class="oth">-</span><span class="num">0.5</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"i&nbsp;is&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">i</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">i</span></div></tt><br />
<tt><div class="freebasic">
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">i</span><span class="oth">,</span>&nbsp;<span class="wrd">j</span><span class="oth">,</span>&nbsp;<span class="wrd">k</span><span class="oth">,</span>&nbsp;<span class="wrd">toTemp</span><span class="oth">,</span>&nbsp;<span class="wrd">stepTemp</span><br />
<span class="wrd">j</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">9</span><span class="oth">:</span>&nbsp;<span class="wrd">k</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span><br />
<br />
<span class="key">For</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">To</span>&nbsp;<span class="wrd">j</span>&nbsp;<span class="key">Step</span>&nbsp;<span class="wrd">k</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">j</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">:</span>&nbsp;<span class="wrd">k</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="com">''&nbsp;Changing&nbsp;j&nbsp;and&nbsp;k&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;current&nbsp;loop.</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">i</span><span class="oth">;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
<span class="key">Next</span>&nbsp;<span class="wrd">i</span><br />
<span class="key">Print</span><br />
<br />
<span class="com">'&nbsp;Internally,&nbsp;this&nbsp;is&nbsp;what&nbsp;the&nbsp;above&nbsp;example&nbsp;does:</span><br />
<span class="wrd">j</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">9</span><span class="oth">:</span>&nbsp;<span class="wrd">k</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span><br />
<br />
<span class="wrd">i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">:</span>&nbsp;<span class="wrd">toTemp</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">j</span><span class="oth">:</span>&nbsp;<span class="wrd">stepTemp</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">k</span><br />
<span class="key">Do</span>&nbsp;<span class="key">While</span>&nbsp;<span class="key">IIf</span><span class="oth">(</span><span class="wrd">stepTemp</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">&lt;=</span>&nbsp;<span class="wrd">toTemp</span><span class="oth">,</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="wrd">toTemp</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">j</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><span class="oth">:</span>&nbsp;<span class="wrd">k</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="com">''&nbsp;Changing&nbsp;j&nbsp;and&nbsp;k&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;current&nbsp;loop.</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="wrd">i</span><span class="oth">;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">+=</span>&nbsp;<span class="wrd">stepTemp</span><br />
<span class="key">Loop</span><br />
<span class="key">Print</span></div></tt><br />
<br \>
</div><div class="fb_sect_title">Diff&eacute;rences de dialecte</div><div class="fb_sect_cont"><br \>
<ul><li> Dans les dialectes <i><a href="CompilerOptlang.html">-lang qb</a></i> et <i><a href="CompilerOptlang.html">-lang fblite</a></i>, les variables d&eacute;clar&eacute;es dans une boucle FOR..NEXT ont une <a href="ProPgVariableScope.html">port&eacute;e</a> &agrave; l'&eacute;chelle de la fonction comme dans QB.<br \>
<li> Dans les dialectes <i><a href="CompilerOptlang.html">-lang fb</a></i> et <i><a href="CompilerOptlang.html">-lang deprecated</a></i> les variables d&eacute;clar&eacute;es dans une boucle <tt><b>For</b></tt>..<tt><b>Next</b></tt> ne sont visibles que dans le bloc et ne peuvent &ecirc;tre utilis&eacute;es en-dehors de lui.<br \>
<br \>
</ul></div><div class="fb_sect_title">Diff&eacute;rences avec QB</div><div class="fb_sect_cont"><br \>
<ul><li> Les arguments <tt><a href="KeyPgByref.html">ByRef</a></tt> ne peuvent &ecirc;tre utilis&eacute;s comme compteurs.<br \>
<br \>
</ul></div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgContinue.html">Continue</a></tt><br \>
<li> <tt><a href="KeyPgDoloop.html">Do...Loop</a></tt><br \>
<li> <tt><a href="KeyPgExit.html">Exit</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
