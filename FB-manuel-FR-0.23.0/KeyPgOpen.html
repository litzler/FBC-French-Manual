<html>
<head>
<title>Open</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Open</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Ouvre un fichier sur le disque pour des op&eacute;rations de lecture/&eacute;criture<br \>
<br \>
<div class="fb_sect_title">Syntaxe</div><div class="fb_sect_cont"><tt><br \>
<b>Open</b> <i>filename</i> <b>For</b> <b><a href="KeyPgInputfilemode.html">Input</a></b> [<i>encoding_type</i>] [<i>lock_type</i>] <b>As</b> [<b>#</b>]<i>filenumber</i><br \>
<b>Open</b> <i>filename</i> <b>For</b> <b><a href="KeyPgOutput.html">Output</a></b> [<i>encoding_type</i>] [<i>lock_type</i>] <b>As</b> [<b>#</b>]<i>filenumber</i><br \>
<b>Open</b> <i>filename</i> <b>For</b> <b><a href="KeyPgAppend.html">Append</a></b> [<i>encoding_type</i>] [<i>lock_type</i>] <b>As</b> [<b>#</b>]<i>filenumber</i><br \>
<br \>
<b>Open</b> <i>filename</i> <b>For</b> <b><a href="KeyPgBinary.html">Binary</a></b> [<i>access_type</i>] [<i>lock_type</i>] <b>As</b> [<b>#</b>]<i>filenumber</i><br \>
<b>Open</b> <i>filename</i> <b>For</b> <b><a href="KeyPgRandom.html">Random</a></b> [<i>access_type</i>] [<i>lock_type</i>] <b>As</b> [<b>#</b>]<i>filenumber</i> [<b>Len =</b> <i>record_length</i>]<br \>
</tt><br \>
</div><div class="fb_sect_title">Usage</div><div class="fb_sect_cont"><tt><br \>
<i>result</i> = <b>Open</b> (<i>filename</i>, <b>For</b> {<b><a href="KeyPgInputfilemode.html">Input</a></b>|<b><a href="KeyPgOutput.html">Output</a></b>|<b><a href="KeyPgAppend.html">Append</a></b>}, <b>As</b> <i>filenumber</i> )<br \>
<div class="fb_indent"></tt><i>ou</i><tt><br \>
</div><i>result</i> = <b>Open</b> (<i>filename</i>, <b>For</b> <b><a href="KeyPgBinary.html">Binary</a></b>, <b><a href="KeyPgAccess.html">Access</a></b> {<b>Read</b>|<b>Write</b>}, <b>As</b> <i>filenumber</i> )<br \>
<div class="fb_indent"></tt><i>ou</i><tt><br \>
</div><i>result</i> = <b>Open</b> (<i>filename</i>, <b>For</b> <b><a href="KeyPgRandom.html">Random</a></b>, <b><a href="KeyPgAccess.html">Access</a></b> {<b>Read</b>|<b>Write</b>}, <b>As</b> <i>filenumber</i> [, <b>Len = </b> <i>record_length</i>] )<br \>
<div class="fb_indent"></tt><i>ou</i><tt><br \>
</div><b>Open</b> <i>filename</i> <b>For</b> {<b><a href="KeyPgInputfilemode.html">Input</a></b>|<b><a href="KeyPgOutput.html">Output</a></b>|<b><a href="KeyPgAppend.html">Append</a></b>} <b>As</b> <i>filenumber</i><br \>
<div class="fb_indent"></tt><i>ou</i><tt><br \>
</div><b>Open</b> <i>filename</i> <b>For</b> <b><a href="KeyPgBinary.html">Binary</a></b> <b><a href="KeyPgAccess.html">Access</a></b> {<b>Read</b>|<b>Write</b>} <b>As</b> <i>filenumber</i><br \>
<div class="fb_indent"></tt><i>ou</i><tt><br \>
</div><b>Open</b> <i>filename</i> <b>For</b> <b><a href="KeyPgRandom.html">Random</a></b> <b><a href="KeyPgAccess.html">Access</a></b> {<b>Read</b>|<b>Write</b>} <b>As</b> <i>filenumber</i> [<b>Len = </b> <i>record_length</i>]<br \>
<br \>
</tt><br \>
</div><div class="fb_sect_title">Param&egrave;tres</div><div class="fb_sect_cont"><br \>
<tt><i>filename</i></tt><br \>
<div class="fb_indent">Une cha&icirc;ne de caract&egrave;res correspondant au nom du fichier &agrave; ouvrir sur le disque. les chemins de fichiers relatifs le sont par rapport au r&eacute;pertoire courant (voir <tt><a href="KeyPgCurdir.html">CurDir</a></tt>).<br \>
</div><tt><i>encoding_type</i></tt><br \>
<div class="fb_indent">Le codage &agrave; utiliser lors de la lecture ou l'&eacute;criture du texte:<br \>
</div><ul><li> <tt>Encodage "ascii"</tt> <i>(l'encodage ASCII est utilis&eacute;, c'est celui par d&eacute;faut)</i><br \>
<li> <tt>Encoding "utf8"</tt> <i>(l'encodage 8-bit Unicode est utilis&eacute;)</i><br \>
<li> <tt>Encoding "utf16"</tt> <i>(l'encodage 16-bit Unicode est utilis&eacute;)</i><br \>
<li> <tt>Encoding "utf32"</tt> <i>(l'encodage 32-bit Unicode est utilis&eacute;)</i><br \>
</ul><tt><i>access_type</i></tt><br \>
<div class="fb_indent">Le type d'acc&egrave;s demand&eacute; par le processus appelant.<br \>
</div><ul><li> <tt>Acc&egrave;s </tt> [<tt>Read</tt>] [<tt>Write</tt>] <i> (lire et &eacute;crire peuvent &ecirc;tre utilis&eacute;s ensemble, c'est la valeur par d&eacute;faut)</i><br \>
</ul><tt><i>lock_type</i></tt><br \>
<div class="fb_indent">Impose des restrictions sur l'acc&egrave;s aux fichiers disque &agrave; partir d'autres processus ("threads" ou programmes):<br \>
</div><ul><li> <tt>Shared</tt> <i>(le fichier peut &ecirc;tre librement consult&eacute; par d'autres processus)</i><br \>
<li> <tt>Lock</tt> [<tt>Read</tt>] [<tt>Write</tt>] <i>(l'acc&egrave;s en lecture et &eacute;criture peut &ecirc;tre refus&eacute; &agrave; d'autres processus)</i><br \>
</ul><tt><i>filenumber</i></tt><br \>
<div class="fb_indent">Un num&eacute;ro de fichier disponible, qui peut &ecirc;tre trouv&eacute; avec <tt><a href="KeyPgFreefile.html">FreeFile</a></tt>, pour se lier au fichier sur le disque.<br \>
</div><tt><i>record_length</i></tt><br \>
<div class="fb_indent">La taille, en octets, de chaque enregistrement lu ou &eacute;crit dans le fichier disque. La valeur par d&eacute;faut est 128.<br \>
<br \>
</div></div><div class="fb_sect_title">Valeur retourn&eacute;e</div><div class="fb_sect_cont"><br \>
Dans la premi&egrave;re utilisation, <tt><b>Open</b></tt> retourne z&eacute;ro (<tt>0</tt>) si succ&egrave;s et une valeur diff&eacute;rente de z&eacute;ro dans les autres cas.<br \>
<br \>
</div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
Ouvre un fichier sur le disque en lecture et/ou en &eacute;criture. Le num&eacute;ro de fichier <tt><i>file_number</i></tt> est li&eacute; au fichier sur le disque, pour une utilisation dans les op&eacute;rations ult&eacute;rieures sur les fichiers, comme <tt><a href="KeyPgInputPp.html">Input #</a></tt> et <tt><a href="KeyPgLock.html">Lock</a></tt>. Le premier num&eacute;ro de fichier disponible peut &ecirc;tre r&eacute;cup&eacute;r&eacute; avec <tt><a href="KeyPgFreefile.html">FreeFile</a></tt>.<br \>
<br \>
Les modes d'ouverture de fichiers <tt><a href="KeyPgInputfilemode.html">Input</a></tt>, <tt><a href="KeyPgOutput.html">Output</a></tt> et <tt><a href="KeyPgAppend.html">Append</a></tt> en entr&eacute;e/sortie s&eacute;quencielle de texte, sont utiles pour la lecture ou l'&eacute;criture de fichiers texte brut. Quand le mode <tt><a href="KeyPgInputfilemode.html">Input</a></tt> est sp&eacute;cifi&eacute;, seules les op&eacute;rations de lecture de fichiers sont utilisables, comme <tt><a href="KeyPgLineinput.html">Line Input #</a></tt> et <tt><a href="KeyPgGetfileio.html">Get #</a></tt>. Si le fichier disque n'existe pas une erreur d'ex&eacute;cution sera produite. Quand le mode <tt><a href="KeyPgOutput.html">Output</a></tt> est sp&eacute;cifi&eacute;, seules les op&eacute;rations d'&eacute;criture de fichiers sont utilisables, comme <tt><a href="KeyPgPrintPp.html">Print #</a></tt> et <tt><a href="KeyPgPutfileio.html">Put #</a></tt>. Si le fichier n'existe pas sur le disque, il est cr&eacute;&eacute; vide. Le mode <tt><a href="KeyPgAppend.html">Append</a></tt> est comme le mode <tt><a href="KeyPgOutput.html">Output</a></tt>, sauf que les op&eacute;rations d'&eacute;criture commenceront &agrave; la fin du fichier disque, s'il existe.<br \>
<br \>
Les modes d'ouverture de fichiers <tt><a href="KeyPgInputfilemode.html">Input</a></tt>, <tt><a href="KeyPgOutput.html">Output</a></tt> et <tt><a href="KeyPgAppend.html">Append</a></tt> permettent &eacute;galement la s&eacute;lection d'un codage de caract&egrave;res &agrave; utiliser lors de la lecture ou l'&eacute;criture de texte dans le fichier disque. Un codage ASCII ou Unicode peut &ecirc;tre sp&eacute;cifi&eacute; (voir ci-dessus la description du param&egrave;tre <tt><i>encoding_type</i></tt>).<br \>
<br \>
Les modes d'ouverture de fichiers <tt><a href="KeyPgBinary.html">Binary</a></tt> et <tt><a href="KeyPgRandom.html">Random</a></tt> permettent un acc&egrave;s al&eacute;atoire (random-access) en lecture ou &eacute;criture de donn&eacute;es binaires de taille arbitraire. Le mode <tt><a href="KeyPgBinary.html">Binary</a></tt> permet la lecture ou l'&eacute;criture de valeurs de donn&eacute;es de type simple, comme <tt><a href="KeyPgByte.html">Byte (=octet)</a></tt> ou <tt><a href="KeyPgLongint.html">LongInt (=entier long)</a></tt>, en utilisant des op&eacute;rations de lecture ou d'&eacute;criture binaire, comme <tt><a href="KeyPgGetfileio.html">Get #</a></tt>. <tt><a href="KeyPgLoc.html">LOC</a></tt> et <tt><a href="KeyPgSeekreturn.html">Seek</a></tt> sont des m&eacute;thodes utilis&eacute;es pour lire et &eacute;crire &agrave; des emplacements arbitraires dans un fichier disque. Le mode <tt><a href="KeyPgRandom.html">Random</a></tt> est similaire &agrave; <tt><a href="KeyPgBinary.html">Binary</a></tt>, sauf que les op&eacute;rations d'entr&eacute;e/sortie utilisent toujours une taille constante de donn&eacute;es lors d'une lecture ou d'une &eacute;criture.<br \>
<br \>
Par d&eacute;faut, les modes <tt><a href="KeyPgBinary.html">Binary</a></tt> et <tt><a href="KeyPgRandom.html">Random</a></tt> permettent les deux op&eacute;rations de lecture et d'&eacute;criture sur le fichier ouvert sur le disque, mais cela peut &ecirc;tre chang&eacute; en sp&eacute;cifiant un type d'acc&egrave;s (voir ci-dessus la description pour le param&egrave;tre <tt><i>access_type</i></tt>).<br \>
<br \>
Pour tout mode, l'acc&egrave;s au fichier ouvert sur le disque peut &ecirc;tre restreint ou accord&eacute; &agrave; d'autres "threads" ou des programmes en sp&eacute;cifiant un type de verrou (voir ci-dessus la description pour le param&egrave;tre <tt><i>lock_type</i></tt>). Si aucun type de verrou n'est sp&eacute;cifi&eacute;, les autres "threads" du programme actuel peuvent librement ouvrir le fichier sur le disque (<tt>Shared</tt>), tandis que d'autres programmes ne peuvent pas (<tt>Lock Read Write</tt>). <tt><a href="KeyPgLock.html">Lock</a></tt> et <tt><a href="KeyPgUnlock.html">Unlock</a></tt> peut &ecirc;tre utilis&eacute;s pour restreindre provisoirement l'acc&egrave;s &agrave; des parties d'un fichier.<br \>
<br \>
Le code d'erreur renvoy&eacute; par <tt><b>Open</b></tt> peut &ecirc;tre v&eacute;rifi&eacute; &agrave; l'aide de <tt><a href="KeyPgErr.html">Err</a></tt> dans la ligne suivante. La version fonction de <tt><b>Open</b></tt> retourne directement le code d'erreur sous forme d'un entier. <br \>
<br \>
</div><div class="fb_sect_title">Exemple</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="com">'&nbsp;Create&nbsp;a&nbsp;string&nbsp;and&nbsp;fill&nbsp;it.</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">buffer</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><span class="oth">,</span>&nbsp;<span class="wrd">f</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<span class="wrd">buffer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Hello&nbsp;World&nbsp;within&nbsp;a&nbsp;file."</span><br />
<br />
<span class="com">'&nbsp;Find&nbsp;the&nbsp;first&nbsp;free&nbsp;file&nbsp;number.</span><br />
<span class="wrd">f</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">FreeFile</span><br />
<br />
<span class="com">'&nbsp;Open&nbsp;the&nbsp;file&nbsp;"file.ext"&nbsp;for&nbsp;binary&nbsp;usage,&nbsp;using&nbsp;the&nbsp;file&nbsp;number&nbsp;"f".</span><br />
<span class="key">Open</span>&nbsp;<span class="quo">"file.ext"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Binary</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">f</span><br />
<span class="key">If</span>&nbsp;<span class="key">Err</span><span class="oth">&gt;</span><span class="num">0</span>&nbsp;<span class="key">Then</span>&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"Error&nbsp;opening&nbsp;the&nbsp;file"</span><span class="oth">:</span><span class="key">End</span><br />
<br />
<span class="com">'&nbsp;Place&nbsp;our&nbsp;string&nbsp;inside&nbsp;the&nbsp;file,&nbsp;using&nbsp;number&nbsp;"f".</span><br />
<span class="key">Put</span>&nbsp;<span class="oth">#</span><span class="wrd">f</span><span class="oth">,</span>&nbsp;<span class="oth">,</span>&nbsp;<span class="wrd">buffer</span><br />
<br />
<span class="com">'&nbsp;Close&nbsp;all&nbsp;open&nbsp;files.&nbsp;&nbsp;</span><br />
<span class="key">Close</span><br />
<br />
<span class="com">'&nbsp;End&nbsp;the&nbsp;program.&nbsp;(Check&nbsp;the&nbsp;file&nbsp;"file.ext"&nbsp;upon&nbsp;running&nbsp;to&nbsp;see&nbsp;the&nbsp;output.)</span><br />
<span class="key">End</span><br />
</div></tt><br />
<br \>
<tt><div class="freebasic">
<span class="com">'OPEN&nbsp;A&nbsp;COM&nbsp;PORT</span><br />
<span class="key">Open</span>&nbsp;<span class="key">Com</span>&nbsp;<span class="quo">"COM1:9600,N,8,1"</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="num">1</span><br />
<span class="key">If</span>&nbsp;<span class="key">Err</span><span class="oth">&gt;</span><span class="num">0</span>&nbsp;<span class="key">Then</span>&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;port&nbsp;could&nbsp;not&nbsp;be&nbsp;opened."</span><br />
<br />
<span class="com">'COM1,&nbsp;9600&nbsp;BAUD,&nbsp;NO&nbsp;PARITY&nbsp;BIT,&nbsp;EIGHT&nbsp;DATA&nbsp;BITS,&nbsp;ONE&nbsp;STOP&nbsp;BIT</span><br />
</div></tt><br />
<tt><div class="freebasic">
<span class="com">'function&nbsp;version&nbsp;of&nbsp;OPEN</span><br />
<span class="key">If</span>&nbsp;<span class="key">Open</span><span class="oth">(</span><span class="quo">"file.ext"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Binary</span>&nbsp;<span class="key">Access</span>&nbsp;<span class="key">Read</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="num">1</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="key">Then</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"Successfully&nbsp;opened&nbsp;file"</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;...</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Close</span>&nbsp;<span class="oth">#</span><span class="num">1</span><br />
<br />
<span class="key">Else</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"Error&nbsp;opening&nbsp;file"</span><br />
<br />
<span class="key">End</span>&nbsp;<span class="key">If</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Diff&eacute;rences de plate-forme</div><div class="fb_sect_cont"><br \>
<ul><li> Linux n&eacute;cessite que la casse de la police de <tt><i>filename</i></tt> corresponde au nom r&eacute;el du fichier. Windows et DOS ne sont pas sensibles &agrave; la casse. <br \>
<li> Les s&eacute;parateurs de chemin de Linux sont des barres obliques <tt>/</tt>. Windows utilise les barres obliques vers l'arri&egrave;re <tt>\</tt> mais il permet les barres obliques .  DOS utilise les barres obliques inverses <tt>\</tt>. <br \>
<li> Sous Windows, un num&eacute;ro de fichier utilis&eacute; dans une biblioth&egrave;que de liens dynamiques n'est pas le m&ecirc;me qu'un num&eacute;ro de fichier identique utilis&eacute; dans le programme principal.  Les num&eacute;ros de dossier ne peut &ecirc;tre pass&eacute;s ou renvoy&eacute;s, puis utilis&eacute;s entre une DLL et un fichier ex&eacute;cutable.<br \>
<br \>
</ul></div><div class="fb_sect_title">Diff&eacute;rences avec QB</div><div class="fb_sect_cont"><br \>
<ul><li>L'utilisation des noms de p&eacute;riph&eacute;riques MS-DOS pour ouvrir des flots ou des p&eacute;riph&eacute;riques (<tt>"LPT:"</tt>, <tt>"SCR:"</tt>, etc.) est permise seulement dans le dialecte <i><a href="CompilerOptlang.html">-lang qb</a></i>; pour les autres modes FreeBasic de nouveaux mots-cl&eacute;s composites doivent &ecirc;tre utilis&eacute;s: voir <tt><a href="KeyPgOpenCom.html">Open Com</a></tt>,  <tt><a href="KeyPgOpenCons.html">Open Cons</a></tt>,  <tt><a href="KeyPgOpenErr.html">Open Err</a></tt>,  <tt><a href="KeyPgOpenPipe.html">Open Pipe</a></tt>,  <tt><a href="KeyPgOpenLpt.html">Open Lpt</a></tt>,  <tt><a href="KeyPgOpenScrn.html">Open Scrn</a></tt>.<br \>
<li> <tt><b>Open</b></tt> peut &ecirc;tre appel&eacute; comme une proc&eacute;dure qui retourne un code d'erreur.<br \>
<br \>
</ul></div><div class="fb_sect_title">Diff&eacute;rences de dialecte</div><div class="fb_sect_cont"><br \>
<ul><li> Le dialecte <i><a href="CompilerOptlang.html">-lang qb</a></i> permet la syntaxe du style GW-BASIC <tt>OPEN mode_string, #filenum, filename [length]</tt> avec mode_string qui peut &ecirc;tre <tt>"I"</tt> pour entr&eacute;e, <tt>"O"</tt> pour sortie, <tt>"A"</tt> pour ajout, <tt>"R"</tt> pour al&eacute;atoire (random), <tt>"B"</tt> pour binaire. <br \>
<br \>
</ul></div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgErr.html">Err</a></tt> et <a href="TblRuntimeErrors.html">Codes des erreurs de fonctionnement</a><br \>
<li> <tt><a href="KeyPgClose.html">Close</a></tt><br \>
<li> <tt><a href="KeyPgFreefile.html">FreeFile</a></tt><br \>
<li> <tt><a href="KeyPgOpenCons.html">Open Cons</a></tt>, <tt><a href="KeyPgOpenErr.html">Open Err</a></tt>, <tt><a href="KeyPgOpenPipe.html">Open Pipe</a></tt>, <tt><a href="KeyPgOpenLpt.html">Open Lpt</a></tt>, <tt><a href="KeyPgOpenCom.html">Open Com</a></tt>, <tt><a href="KeyPgOpenScrn.html">Open Scrn</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
