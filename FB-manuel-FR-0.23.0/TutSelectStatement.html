<html>
<head>
<title>The Select Case Statement</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">L'instruction Select Case</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	<i>Ecrit par <a href="WikiRick.html">rdc</a></i><br \>
<br \>
Le bloc <b>Select Case</b> peut &ecirc;tre consid&eacute;r&eacute;e comme une s&eacute;rie If-ElseIf optimis&eacute;e et fonctionne de la m&ecirc;me mani&egrave;re. Le format standard de <b>Select Case</b> peut utiliser n'importe lequel des types de donn&eacute;es standard pour &lt;expression&gt; et le format <b>Select Case As Const</b> est optimis&eacute; pour les valeurs enti&egrave;res.
<br \>
<br \>
Cet extrait de code montre la syntaxe de <b>Select Case</b>e standard. L'expression est g&eacute;n&eacute;ralement une variable qui peut &ecirc;tre de l'un des types de donn&eacute;es standard ou des &eacute;l&eacute;ments individuels d'un type ou d'un tableau.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Select</span>&nbsp;<span class="key">Case</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">expression</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">list</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span>&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
<span class="key">End</span>&nbsp;<span class="key">Select</span><br />
</div></tt><br />
<br \>
La clause &lt;list&gt; de l'instruction <b>Case</b> peut avoir n'importe lequel des formats suivants.<br \>
<br \>
<div class="fb_indent"> Case &lt;value&gt;: Value est l'un des types de donn&eacute;es pris en charge ou une &eacute;num&eacute;ration. <br \>
 Case &lt;value&gt; To &lt;value&gt;: Sp&eacute;cifie une plage de valeurs.<br \>
 Case Is &lt;operator&gt; &lt;value&gt;: L'op&eacute;rateur est l'un des op&eacute;rateurs logiques.<br \>
 Case &lt;value&gt;, &lt;value&gt;, ...: Liste de valeurs s&eacute;par&eacute;es par des virgules.<br \>
 Case &lt;variable&gt;: Une variable qui contient une valeur.<br \>
<br \>
</div>L'extrait suivant illustre comment ces diff&eacute;rents formats peuvent &ecirc;tre utilis&eacute;s dans un programme.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Case</span>&nbsp;<span class="num">47</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="num">47</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">59</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="key">Is</span>&nbsp;<span class="oth">&gt;</span>&nbsp;<span class="num">60</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="num">47</span><span class="oth">,</span>&nbsp;<span class="num">48</span><span class="oth">,</span>&nbsp;<span class="num">53</span><br />
<br />
<span class="key">Case</span>&nbsp;<span class="wrd">keycode</span><br />
</div></tt><br />
<br \>
<b>Select Case As Const</b> est une version plus rapide de la d&eacute;claration <b>Select</b> visant &agrave; travailler avec des expressions enti&egrave;res dans la plage de 0 &agrave; 4097.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Select</span>&nbsp;<span class="key">Case</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Const</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">integer_expression</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="oth">&lt;</span><span class="wrd">list</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span>&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="key">Else</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">&lt;</span><span class="wrd">statement</span><span class="oth">&gt;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br />
<span class="key">End</span>&nbsp;<span class="key">Select</span><br />
</div></tt><br />
<br \>
La &lt;list&gt; des formats de d&eacute;claration pour <b>Select Case As Const</b> sont limit&eacute;s &agrave; des valeurs ou des &eacute;num&eacute;rations de valeurs. Autrement dit, les expressions op&eacute;rateurs sont pas autoris&eacute;s dans un cas <b>As Const</b>.<br \>
<br \>
Quand un bloc <b>Case</b> est ex&eacute;cut&eacute;, les instructions suivant le mot-cl&eacute; <b>Case</b> jusqu'au mot-cl&eacute; <b>Case</b> (ou End Select) suivant seront ex&eacute;cut&eacute;es. Un seul bloc d'instructions dans un <b>Case</b> sera ex&eacute;cut&eacute; &agrave; un moment donn&eacute;. Si un <b>Case Else</b> est pr&eacute;sent, alors les instructions dans le bloc <b>Else</b> seront ex&eacute;cut&eacute;es si aucun <b>Case</b> ne correspond &agrave; la portion de la d&eacute;claration <b>Select</b>. Le programme suivant illustre l'utilisation du bloc <b>Select Case</b>.<br \>
<br \>
<tt><div class="freebasic">
<span class="com">'Ascii&nbsp;code&nbsp;of&nbsp;key&nbsp;press</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">keycode</span><br />
<br />
<span class="com">'Loop&nbsp;until&nbsp;esc&nbsp;key&nbsp;is&nbsp;pressed</span><br />
<span class="key">Do</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Asc</span><span class="oth">(</span><span class="key">Inkey</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Select</span>&nbsp;<span class="key">Case</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Const</span>&nbsp;<span class="wrd">keycode</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">48</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">57</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"You&nbsp;pressed&nbsp;a&nbsp;number&nbsp;key."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">65</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">90</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"You&nbsp;pressed&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter&nbsp;key."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">97</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">122</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"You&nbsp;pressed&nbsp;a&nbsp;lower&nbsp;case&nbsp;key."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">Select</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Sleep</span>&nbsp;<span class="num">1</span><br />
<span class="key">Loop</span>&nbsp;<span class="key">Until</span>&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">27</span>&nbsp;<span class="com">'27&nbsp;is&nbsp;the&nbsp;ascii&nbsp;code&nbsp;for&nbsp;Escape</span><br />
<br />
<span class="key">End</span><br />
</div></tt><br />
<br \>
Dans le programme, lorsque vous appuyez sur une touche, la valeur est traduite en un nombre en utilisant la fonction Asc. Puisque ce sera toujours une valeur enti&egrave;re inf&eacute;rieure &agrave; 4097 (car les codes de caract&egrave;res ascii vont de 0 &agrave; 255), le format utilis&eacute; est <b>Select Case As Const</b>.<br \>
<br \>
Le compilateur dcompare la valeur de code de touche avec chacun des <b>Case</b> pour voir si le bloc doit s'ex&eacute;cuter. Si le code de touche se situe dans une fourchette particuli&egrave;re, la d&eacute;claration d'affichage va ex&eacute;cuter, puis le flux du programme se poursuivra avec la ligne qui suit <b>End Select</b>. S'il ne correspond &agrave; aucun des <b>Case</b>, alors le programme se poursuivra avec la ligne qui suit <b>End Select</b>.<br \>
<br \>
Un bloc <b>Select Case</b> est g&eacute;n&eacute;ralement la traduction d'un bloc si-ElseIf. Pour illustrer cela, le programme pr&eacute;c&eacute;dent est transform&eacute; ci-dessous en bloc <b>If-ElseIf</b>.<br \>
<br \>
<tt><div class="freebasic">
<span class="com">'Ascii&nbsp;code&nbsp;of&nbsp;key&nbsp;press</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="wrd">keycode</span><br />
<br />
<span class="com">'Loop&nbsp;until&nbsp;esc&nbsp;key&nbsp;is&nbsp;pressed</span><br />
<span class="key">Do</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Asc</span><span class="oth">(</span><span class="key">Inkey</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="num">48</span><span class="oth">)</span>&nbsp;<span class="key">And</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&lt;=</span>&nbsp;<span class="num">57</span><span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"You&nbsp;pressed&nbsp;a&nbsp;number&nbsp;key."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ElseIf</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="num">65</span><span class="oth">)</span>&nbsp;<span class="key">And</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&lt;=</span>&nbsp;<span class="num">90</span><span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"You&nbsp;pressed&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter&nbsp;key."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ElseIf</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&gt;=</span>&nbsp;<span class="num">97</span><span class="oth">)</span>&nbsp;<span class="key">And</span>&nbsp;<span class="oth">(</span><span class="wrd">keycode</span>&nbsp;<span class="oth">&lt;=</span>&nbsp;<span class="num">122</span><span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"You&nbsp;pressed&nbsp;a&nbsp;lower&nbsp;case&nbsp;key."</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Sleep</span>&nbsp;<span class="num">1</span><br />
<span class="key">Loop</span>&nbsp;<span class="key">Until</span>&nbsp;<span class="wrd">keycode</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">27</span>&nbsp;<span class="com">'27&nbsp;is&nbsp;the&nbsp;ascii&nbsp;code&nbsp;for&nbsp;Escape</span><br />
<br />
<span class="key">End</span><br />
</div></tt><br />
<br \>
Si vous comparez les deux programmes, vous pouvez voir que la logique est assez similaire, mais le <b>Select Case</b> est beaucoup plus lisible et plus compr&eacute;hensible que le bloc <b>If-ElseIf</b>.<br \>

</div>
</div> 
</div> 
</body>
</html>
