<html>
<head>
<title>Introduction to the Type Def</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Introduction &agrave; Type Def</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif"></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	<i>Ecrit par <a href="WikiRick.html">rdc</a></i><br \="">
<br \="">Il y a des moments, lors de la cr&eacute;ation d'un programme, o&ugrave; l'on souhaite d&eacute;finir une structure globale comme un enregistrement personnel ou un ennemi dans un jeu. Alors que vous pouvez faire cela en utilisant des types de donn&eacute;es individuelles, cela est difficile &agrave; g&eacute;rer dans un programme. Les types de donn&eacute;es composites vous permettent de grouper des &eacute;l&eacute;ments de donn&eacute;es connexes dans une structure unique qui peut &ecirc;tre manipul&eacute;e comme une seule entit&eacute;. FreeBasic offre deux types de donn&eacute;es composites, <tt><b>Type</b></tt> et <tt><b>Union</b></tt>. <br \="">
<br \="">
<div class="fb_header"> Types </div><br \="">
<br \="">
FreeBasic vous permet de grouper plusieurs types de donn&eacute;es dans une structure unifi&eacute;e appel&eacute;e une d&eacute;finition de <tt><b>Type</b></tt> que vous pouvez utiliser pour d&eacute;crire ces structures de donn&eacute;es agr&eacute;g&eacute;es.<br \="">
<br \="">
La structure de base d'une d&eacute;finition de <tt><b>Type</b></tt> est:<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">typename</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Var</span>&nbsp;<span class="wrd">definition</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Var</span>&nbsp;<span class="wrd">definition</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">...</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span><br>
</div></tt><br>
<br \="">
Le bloc <tt><b>Type ... Type-End</b></tt> d&eacute;finit la port&eacute;e de la d&eacute;finition. Vous d&eacute;finissez les &eacute;l&eacute;ments de la structure <tt><b>Type</b></tt> de la m&ecirc;me mani&egrave;re que vous utilisez le mot cl&eacute; <tt><b>Dim</b></tt>, sans utiliser <tt><b>Dim</b></tt>. L'extrait de code suivant montre comment construire un <tt><b>Type</b></tt> d'<tt><i>Employee</i></tt>.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">EmployeeType</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">fname</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="num">10</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">lname</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="num">10</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">empid</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">dept</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;<br>
</div></tt><br>
<br \="">
Vous pouvez utiliser n'importe quel type de donn&eacute;es comme &eacute;l&eacute;ment de donn&eacute;es, y compris des pointeurs et d'autres d&eacute;finitions de <tt><b>Type</b></tt>. Lorsque vous cr&eacute;ez la d&eacute;finition d'un <tt><b>Type</b></tt>, comme dans l'exemple ci-dessus, vous &ecirc;tes juste en train de cr&eacute;er un mod&egrave;le pour le compilateur. Afin d'utiliser la d&eacute;finition du <tt><b>Type</b></tt>, vous devez cr&eacute;er une variable de ce <tt><b>Type</b></tt>, comme le montre l'extrait de code suivant.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Dim</span>&nbsp;<span class="wrd">Employee</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">EmployeeType</span><br>
</div></tt><br>
<br \="">
Lorsque vous avez cr&eacute;&eacute; une variable de ce <tt><b>Type</b></tt>, vous pouvez acc&eacute;der &agrave; chaque &eacute;l&eacute;ment dans le <tt><b>Type</b></tt> l'aide de la notation point&eacute;e  <tt><i>var_name.field_name</i></tt>.  <br \="">
<br \="">
En utilisant l'exemple ci-dessus, pour acc&eacute;der au champ <tt><i>fname</i></tt> vous pouvez utiliser: <br \="">
<br \="">
<tt><div class="freebasic">
<span class="wrd">Employee.fname</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">"</span><span class="wrd">Susan</span><span class="oth">"</span><br>
</div></tt><br>
<br \="">
<div class="fb_header"> Utiliser With </div><br \="">
<br \="">
Pour acc&eacute;der &agrave; des champs multiples au m&ecirc;me moment, vous pouvez utiliser le bloc <tt><b>With-End With</b></tt>. Le code suivant montre comment utiliser le bloc <tt><b>With</b></tt> avec l'exemple ci-dessus.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">With</span>&nbsp;<span class="wrd">Employee</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">fname</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Susan"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lname</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Jones"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">empid</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1001</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">dept</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">24</span><br>
<span class="key">End</span>&nbsp;<span class="key">With</span>&nbsp;&nbsp;&nbsp;&nbsp;<br>
</div></tt><br>
<br \="">
Le compilateur lie automatiquement la variable <tt><i>Employee</i></tt> avec les &eacute;l&eacute;ments de donn&eacute;es individuels du bloc. Non seulement cela signifie que vous n'avez pas &agrave; &eacute;crire beaucoup plus, mais la structure est optimis&eacute;e et un peu plus rapide que l'utilisation de la notation point&eacute;e compl&egrave;te.<br \="">
<br \="">
<div class="fb_header"> Transmission de Types aux sous-routines et fonctions </div><br \="">
<br \="">
Un avantage de l'utilisation de <tt><b>Type</b></tt> dans votre programme est que vous pouvez passer la structure &agrave; un sous-programme ou une fonction et op&eacute;rer sur la structure dans son ensemble. Le fragment de code suivant montre une d&eacute;finition partielle de sous-routine.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">UpdateEmployeeDept</span><span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">Emp</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">EmployeeType</span><span class="oth">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><br>
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br>
</div></tt><br>
<br \="">
Notez que le param&egrave;tre est qualifi&eacute; avec <tt><b>Byref</b></tt>. Ceci est important puisque vous voulez mettre &agrave; jour ce <tt><b>Type</b></tt> dans la sous-routine. Il existe deux modes de passage de param&egrave;tres en FreeBasic: <tt><b>ByRef</b></tt> et <tt><b>Byval</b></tt>. <br \="">
<br \="">
<b> Byref et Byval: Pr&eacute;sentation rapide </b><br \="">
<br \="">
<tt><b>ByRef</b></tt> et <tt><b>Byval</b></tt> indiquent au compilateur comment passer une r&eacute;f&eacute;rence &agrave; une sous-routine ou une fonction. Lorsque vous utilisez <tt><b>ByRef</b></tt>, ou <i>Par R&eacute;f&eacute;rence</i>, vous passez un pointeur de r&eacute;f&eacute;rence au param&egrave;tre et toutes les modifications que vous apportez au param&egrave;tre &agrave; l'int&eacute;rieur de <tt><b>Sub</b></tt> ou <tt><b>Function</b></tt> sera refl&eacute;t&eacute;e dans la variable r&eacute;elle qui a &eacute;t&eacute; pass&eacute;e. En d'autres termes, le param&egrave;tre <tt><b>ByRef</b></tt> pointe sur la variable r&eacute;elle dans la m&eacute;moire.<br \="">
<br \="">
<tt><b>Byval</b></tt>, ou <i>Par Valeur</i>, d'autre part fait une copie du param&egrave;tre et toutes les modifications apport&eacute;es &agrave; l'int&eacute;rieur de <tt><b>Sub</b></tt> ou <tt><b>Function</b></tt> sont locales et ne seront pas refl&eacute;t&eacute;es dans la variable r&eacute;elle qui a &eacute;t&eacute; pass&eacute;e. Le param&egrave;tre <tt><b>Byval</b></tt> pointe sur une copie de la variable et non sur la variable r&eacute;elle, elle-m&ecirc;me.<br \="">
<br \="">
Par d&eacute;faut FreeBasic .17 passe les param&egrave;tres en utilisant <tt><b>Byval</b></tt>. Pour modifier un param&egrave;tre pass&eacute;, vous devez &agrave; sp&eacute;cifier le qualificatif <tt><b>ByRef</b></tt>. Dans cet exemple, la sous-routine met &agrave; jour le <i>department id</i> du <i>Type employee</i>, donc le param&egrave;tre est qualifi&eacute; par <tt><b>ByRef</b></tt> pour que la sous-routine puisse mettre &agrave; jour le champ <i>dept</i> de la variable.<br \="">
<br \="">
En revanche vous n'avez pas besoin de mettre &agrave; jour le <tt><b>Type</b></tt> comme dans le fragment de code suivant.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">PrintEmployeeRecord</span><span class="oth">(</span><span class="wrd">Emp</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">EmployeeType</span><span class="oth">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><br>
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br>
</div></tt><br>
<br \="">
Dans cette sous-routine on affiche seulement l'enregistrement de <i>employee</i> &agrave; l'&eacute;cran ou on l'envoie vers l'imprimante et on n'a pas a chang&eacute; quoi que ce soit dans la variable <tt><b>Type</b></tt>. Ici c'est <tt><b>Byval</b></tt> par d&eacute;faut qui est utilis&eacute; pour passer une copie de l'enregistrement de <i>employee</i> &agrave; la sous-routine au lieu d'une r&eacute;f&eacute;rence vers la variable. En utilisant <tt><b>Byval</b></tt>, dans ce cas, vous &eacute;vitez de changer quelque chose accidentellement dans la variable <tt><b>Type</b></tt>, ce que vous ne d&eacute;siriez pas.<br \="">
<br \="">
Vous ne devez utiliser <tt><b>Byref</b></tt> que si vous avez l'intention de modifier les donn&eacute;es des param&egrave;tres. Il est beaucoup plus plus s&ucirc;r d'utiliser <tt><b>Byval</b></tt> dans les cas o&ugrave; vous devez avoir les donn&eacute;es des param&egrave;tres, mais que vous souhaitez &eacute;viter toute modification accidentelle de ces donn&eacute;es. Ces modifications accidentelles g&eacute;n&egrave;rent des bugs difficiles &agrave; trouver dans les programmes.<br \="">
<br \="">
<div class="fb_header"> Types dans les Types </div><br \="">
<br \="">
En plus des types de donn&eacute;es intrins&egrave;ques, un champ de Type peut &eacute;galement &ecirc;tre bas&eacute; sur une d&eacute;finition de Type. Pourquoi vouloir faire cela? Une des raisons est l'abstraction de donn&eacute;es. Plus vos structures de donn&eacute;es seront g&eacute;n&eacute;rales, plus vous pourrez en r&eacute;utiliser le code dans d'autres parties de votre programme. Moins vous avez &agrave; &eacute;crire de code, moins les erreurs auront de chance de trouver le chemin de vos programmes. <br \="">
<br \="">
En utilisant l'exemple d'<tt><i>Employee</i></tt>, supposons un instant que vous ayez besoin de plus d'informations <tt><i>dept</i></tt> que seulement <tt><i>department id</i></tt>. Vous pourriez avoir besoin de garder une trace de <tt><i>department manager</i></tt>, l'emplacement du d&eacute;partement, comme le <tt><i>floor</i></tt> (&eacute;tage) ou le bâtiment ou le num&eacute;ro de t&eacute;l&eacute;phone principal du d&eacute;partement. En mettant ces informations dans une d&eacute;finition de <tt><b>Type</b></tt> distincte, vous pouvez utiliser cette information par elle-m&ecirc;me ou comme partie d'une autre d&eacute;finition de <tt><b>Type</b></tt> comme <tt><i>Employee</i></tt>. En g&eacute;n&eacute;ralisant vos structures de donn&eacute;es, votre programme sera plus petit et beaucoup plus robuste.<br \="">
<br \="">
L'utilisation d'un <tt><b>Type</b></tt> dans un <tt><b>Type</b></tt> est identique &agrave; celle de l'un des types de donn&eacute;es intrins&egrave;ques. Les extraits de code suivant illustrent un <tt><b>Type</b></tt> <tt><i>department</i></tt> &eacute;tendu et un <tt><b>Type</b></tt> <tt><i>employee</i></tt> mis &agrave; jour.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">DepartmentType</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">id</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">managerid</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">floor</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<br>
<span class="key">Type</span>&nbsp;<span class="wrd">EmployeeType</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">fname</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="num">10</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">lname</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="num">10</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">empid</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">dept</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">DepartmentType</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span><br>
<br>
<span class="key">Dim</span>&nbsp;<span class="wrd">Employee</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">EmployeeType</span><br>
</div></tt><br>
<br \="">
Notez que dans la d&eacute;finition de <tt><i>Employee</i></tt> le champ <tt><i>dept</i></tt> est d&eacute;fini comme <tt><i>DepartmentType</i></tt> au lieu d'un des types de donn&eacute;es intrins&egrave;ques. Pour acc&eacute;der &agrave; l'information <tt><i>department</i></tt> dans le <tt><b>Type</b></tt> <tt><i>Employee</i></tt>, on utilise la notation point&eacute;e compos&eacute;e pour acc&eacute;der aux champs de <tt><i>dept</i></tt>:<br \="">
<br \="">
<tt><div class="freebasic">
<span class="wrd">Employee.dept.id</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">24</span><br>
<span class="wrd">Employee.dept.managerid</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1012</span><br>
<span class="wrd">Employee.dept.floor</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">13</span><br>
</div></tt><br>
<br \="">
Le plus haut niveau de la d&eacute;finition du <tt><b>Type</b></tt> est <tt><i>Employee</i></tt>, donc sa r&eacute;f&eacute;rence vient en premier. Comme <tt><i>dept</i></tt> est maintenant une d&eacute;finition de <tt><b>Type</b></tt>, vous devez utiliser l'identifieur de <tt><i>dept</i></tt> pour acc&eacute;der aux champs individuels de <tt><i>DepartmentType</i></tt>. <tt><i>Employee</i></tt> se r&eacute;f&egrave;re au <tt><b>Type</b></tt> <tt><i>employee</i></tt>, <tt><i>dept</i></tt> se r&eacute;f&egrave;re au <tt><b>Type</b></tt> <tt><i>department</i></tt> et <tt><i>id</i></tt>, <tt><i>managerid</i></tt> et <tt><i>floor</i></tt> sont des champs du <tt><b>Type</b></tt> <tt><i>department</i></tt>.<br \="">
<br \="">
Vous pouvez m&ecirc;me faire davantage, notamment avec un <tt><b>Type</b></tt> dans un <tt><b>Type</b></tt> dans un <tt><b>Type</b></tt>. Vous utiliserez simplement la notation point&eacute;e du niveau de type suppl&eacute;mentaires au besoin. Bien qu'il n'y ait pas de limite au niveau des d&eacute;finitions de types imbriqu&eacute;s, cela devient un peu lourd lors de l'utilisation de nombreux niveaux.<br \="">
<br \="">
<div class="fb_header"> With et les Types imbriqu&eacute;s </div><br \="">
<br \="">
Vous pouvez aussi utiliser un bloc <tt><b>With-End With</b></tt> avec des <tt><b>Type</b></tt>s imbriqu&eacute;s, en imbriquant le bloc <tt><b>With</b></tt>, comme illustr&eacute; dans l'exemple ci-dessous.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">With</span>&nbsp;<span class="wrd">Employee</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">fname</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Susan"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lname</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Jones"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">empid</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1001</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">With</span>&nbsp;<span class="oth">.</span><span class="wrd">dept</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">id</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">24</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">managerid</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1012</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">floor</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">13</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">With</span><br>
<span class="key">End</span>&nbsp;<span class="key">With</span><br>
</div></tt><br>
<br \="">
Notez que le second <tt><b>With</b></tt> utilise la notation point&eacute;e, <tt><i>.dept</i></tt>, pour sp&eacute;cifier le niveau suivant de d&eacute;finition de <tt><b>Type</b></tt>. Quand vous utilisez des blocs <tt><b>With</b></tt> imbriqu&eacute;s, assurez-vous que toutes les d&eacute;clarations <tt><b>End With</b></tt> correspondent correctement &agrave; une d&eacute;claration <tt><b>With</b></tt> sinon il y aura un message d'erreur lors de la compilation.<br \="">
<br \="">
<div class="fb_header"> Affectations de Type </div><br \="">
<br \="">
Pour aller plus loin dans l'extension de l'id&eacute;e d'abstraction des donn&eacute;es, il serait int&eacute;ressant de s&eacute;parer l'initialisation du <tt><b>Type</b></tt> <tt><i>department</i></tt> de celle du <tt><b>Type</b></tt> <tt><i>employee</i></tt>. En s&eacute;parant les deux fonctions, vous pouvez facilement ajouter des informations suppl&eacute;mentaires &agrave; <tt><i>department</i></tt> en fonction de vos besoins. C'est l&agrave; que vous pouvez utiliser des assignations de <tt><b>Type</b></tt>. <br \="">
<br \="">
Tout comme vous pouvez affecter un type intrins&egrave;que des donn&eacute;es &agrave; un autre, vous pouvez affecter une variable de <tt><b>Type</b></tt> &agrave; une autre variable de <tt><b>Type</b></tt>, &agrave; condition qu'elles aient la m&ecirc;me d&eacute;finition de <tt><b>Type</b></tt>.<br \="">
<br \="">
Les extraits de code suivants r&eacute;sument la fonction d'initialisation de <tt><i>department</i></tt> et attribue le r&eacute;sultat au <tt><b>Type</b></tt> <tt><i>department</i></tt> dans le <tt><b>Type</b></tt> <tt><i>Employee</i></tt>.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="com">'This&nbsp;function&nbsp;will&nbsp;init&nbsp;the&nbsp;dept&nbsp;type&nbsp;and&nbsp;return&nbsp;it&nbsp;to&nbsp;caller</span><br>
<span class="key">Function</span>&nbsp;<span class="wrd">InitDept</span><span class="oth">(</span><span class="wrd">deptid</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">DepartmentType</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">tmpDpt</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">DepartmentType</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Select</span>&nbsp;<span class="key">Case</span>&nbsp;<span class="wrd">deptid</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">24</span>&nbsp;<span class="com">'dept&nbsp;24</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">With</span>&nbsp;<span class="wrd">tmpDpt</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">id</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">deptid</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">managerid</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1012</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">floor</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">13</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">With</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="num">48</span>&nbsp;<span class="com">'dept&nbsp;48</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">With</span>&nbsp;<span class="wrd">tmpDpt</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">id</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">deptid</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">managerid</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1024</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">floor</span>&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="num">12</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">With</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="key">Else</span>&nbsp;<span class="com">'In&nbsp;case&nbsp;a&nbsp;bad&nbsp;department&nbsp;id&nbsp;was&nbsp;passed</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">With</span>&nbsp;<span class="wrd">tmpDpt</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">id</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">managerid</span>&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">floor</span>&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">With</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">Select</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'Return&nbsp;the&nbsp;dept&nbsp;info</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">tmpDpt</span><br>
<span class="key">End</span>&nbsp;<span class="key">Function</span><br>
<br>
<span class="com">'Create&nbsp;an&nbsp;instance&nbsp;of&nbsp;the&nbsp;type</span><br>
<span class="key">Dim</span>&nbsp;<span class="wrd">Employee</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">EmployeeType</span><br>
<br>
<span class="com">'Initialize&nbsp;the&nbsp;Employee&nbsp;type</span><br>
<span class="key">With</span>&nbsp;<span class="wrd">Employee</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">fname</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Susan"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lname</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Jones"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">empid</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1001</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">dept</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">InitDept</span><span class="oth">(</span><span class="num">24</span><span class="oth">)</span>&nbsp;<span class="com">'get&nbsp;dept&nbsp;info</span><br>
<span class="key">End</span>&nbsp;<span class="key">With</span><br>
</div></tt><br>
<br \="">
Comme vous pouvez le voir dans l'extrait ci-dessus, le champ <tt><i>dept</i></tt> du <tt><b>Type</b></tt> <tt><i>employee</i></tt> est initialis&eacute; par un appel &agrave; une fonction. La fonction <tt><i>InitDept</i></tt> retourne un <tt><i>DepartmentType</i></tt> et le compilateur affectera ce <tt><b>Type</b></tt> au champ de l'enregistrement <tt><i>Employee</i></tt>. <br \="">
<br \="">
Par le simple ajout d'une fonction au programme, vous avez rendu le programme plus facile &agrave; maintenir. Si un nouveau <tt><i>department</i></tt> est cr&eacute;&eacute;, vous pouvez simplement mettre &agrave; jour la fonction <tt><i>InitDept</i></tt> avec le nouveeau <tt><i>department</i></tt>, recompiler et le programme est pr&ecirc;t &agrave; red&eacute;marrer.<br \="">
<br \="">
<div class="fb_header"> Champs de bits </div><br \="">
<br \="">
Il y a encore un autre <tt><b>Type</b></tt> de donn&eacute;es qui peuvent &ecirc;tre utilis&eacute;s dans les d&eacute;finitions de <tt><b>Type</b></tt>, le champ de bits. Les champs de bits sont d&eacute;finis ainsi <tt><i>variable_name: bits As DataType</i></tt>.
Le nom de la variable doit &ecirc;tre suivi de deux-points (:), le nombre de bits, suivi par le type de donn&eacute;es. Seuls les donn&eacute;es de <tt><b>Type</b></tt> entier sont autoris&eacute;es dans un champ de bits. Les champs de bits sont utiles lorsque vous avez besoin de garder une trace d'informations de type bool&eacute;en. Un bit peut avoir les valeurs 0 ou 1, ce qui peut repr&eacute;senter Oui ou Non, Marche ou Arr&ecirc;t ou m&ecirc;me Noir et Blanc. <br \="">
<br \="">
L'extrait de code suivant illustre la d&eacute;finition d'un champ de bits.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">BitType</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">b1</span><span class="oth">:</span>&nbsp;<span class="num">1</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">b2</span><span class="oth">:</span>&nbsp;<span class="num">4</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span><br>
</div></tt><br>
<br \="">
b1 est d&eacute;fini comme bit unique et b2 comme ayant quatre bits. Vous initialisez les champs de bits en passant les bits individuels aux champs du <tt><b>Type</b></tt>.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="wrd">myBitType.b1</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span><br>
<span class="wrd">myBitType.b2</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1101</span><br>
</div></tt><br>
<br \="">
Le type de donn&eacute;es du champ de bits d&eacute;termine le nombre de bits que vous pouvez d&eacute;clarer, dans un champ de bits. Puisqu' un entier &agrave; une longueur de 32 bits, vous pouvez d&eacute;clarer jusqu'&agrave; 32 bits dans le champ. Cependant, dans la plupart des cas, vous allez d&eacute;clarer un seul bit pour chaque champ et utiliser un certain nombre de champs afin de d&eacute;finir le masque de bits que vous souhaitez utiliser. Utiliser un bit unique simplifie le codage que vous devez &eacute;l&eacute;borer pour d&eacute;terminer si un bit est activ&eacute; ou d&eacute;sactiv&eacute; et vous permet d'identifier facilement ce qu'un bit signifie dans la d&eacute;finition du <tt><b>Type</b></tt>.<br \="">
<br \="">
<div class="fb_header"> La propri&eacute;t&eacute; Field </div><br \="">
<br \="">
Lorsque vous cr&eacute;ez une variable d'un <tt><b>Type</b></tt> d&eacute;fini, le <tt><b>Type</b></tt> est <tt><i>bourr&eacute;</i></tt> en m&eacute;moire. Le <tt><i>bourrage</i></tt> permet un acc&egrave;s plus rapide des membres de <tt><b>Type</b></tt> puisque ses champs sont align&eacute;s dans les limites d'un <tt><i>Word</i></tt> de 4 octets. Cependant, cela peut causer des probl&egrave;mes lorsque vous essayez de lire un enregistrement de <tt><b>Type</b></tt> &agrave; partir d'un fichier qui n'est pas <tt><i>bourr&eacute;</i></tt>. Vous pouvez utiliser la propri&eacute;t&eacute; <tt><b>Field</b></tt> d'un champ pour changer le stockage en m&eacute;moire de la d&eacute;finition du <tt><b>Type</b></tt>. <br \="">
<br \="">
Le mot-clef <tt><b>Field</b></tt> est utilis&eacute; juste &agrave; droite du nom du <tt><b>Type</b></tt> et peut avoir les valeurs 1, pour un alignement sur 1 octet (sans bourrage), 2 un alignement sur 2 octets et 4 un alignement sur 4 octets. Pour d&eacute;finir un <tt><b>Type</b></tt> sans <tt><i>bourrage</i></tt> vous utiliserez la syntaxe suivante.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">myType</span>&nbsp;<span class="key">Field</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">v1</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">v2</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Byte</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span><br>
</div></tt><br>
<br \="">
Pour un alignement sur 2 octets utilisez <tt><b>Field</b></tt> = 2. Si aucune propri&eacute;t&eacute; <tt><b>Field =</b></tt> n'est attribu&eacute;e, le <tt><i>bourrage</i></tt> est alors de 4 octets. Si vous lisez une d&eacute;finition de <tt><b>Type</b></tt> cr&eacute;&eacute;e sous FreeBasic en utilisant l'alignement par d&eacute;faut, vous n'avez pas besoin, dans ce cas, d'utiliser la propri&eacute;t&eacute; <tt><b>Field</b></tt>.<br \="">
<br \="">
<div class="fb_table"><table><tbody><tr><td> Si vous lisez un enregistrement Quick Basic d'un <tt><b>Type</b></tt>, alors vous devez utiliser <tt><b>Field</b></tt> = 1, car QB utilisait l'alignement des octets par d&eacute;faut.</td></tr></tbody></table></div><br \="">
<br \="">
<div class="fb_header"> Initialisation de Type </div><br \="">
<br \="">
Vous pouvez initialiser une d&eacute;finition de <tt><b>Type</b></tt> lorsque vous dimensionnez le <tt><b>Type</b></tt> comme vous le feriez avec une variable intrins&egrave;que. L'extrait de code suivant illustre la syntaxe.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Type</span>&nbsp;<span class="wrd">aType</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">a</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">b</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Byte</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">c</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span>&nbsp;<span class="oth">*</span>&nbsp;<span class="num">10</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span><br>
<br>
<span class="key">Dim</span>&nbsp;<span class="wrd">myType</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">aType</span>&nbsp;<span class="oth">=&gt;</span>&nbsp;<span class="oth">(</span><span class="num">12345</span><span class="oth">,</span>&nbsp;<span class="num">12</span><span class="oth">,</span>&nbsp;<span class="quo">"Hello"</span><span class="oth">)</span><br>
</div></tt><br>
<br \="">
Dans l'instruction <tt><b>Dim</b></tt>, l'op&eacute;rateur fl&egrave;che <i>+&gt;</i> est utilis&eacute; pour indiquer au compilateur que vous initialisez la variable <tt><b>Type</b></tt>. Les valeurs des &eacute;l&eacute;ments de <tt><b>Type</b></tt> doivent &ecirc;tre plac&eacute;s entre parenth&egrave;ses et s&eacute;par&eacute;s par des virgules. L'ordre de la liste de valeurs correspond &agrave; l'ordre des &eacute;l&eacute;ments de <tt><b>Type</b></tt>, o&ugrave; <tt><b>a</b></tt> sera mis &agrave; 12345, <tt><b>b</b></tt> &agrave; 12 et <tt><b>c</b></tt> &agrave; “Hello”. <br \="">
<br \="">
<div class="fb_table"><table><tbody><tr><td> Vous ne pouvez pas initialiser une cha&icirc;ne dynamique au sein d'une d&eacute;finition de <tt><b>Type</b></tt> en utilisant cette m&eacute;thode. La cha&icirc;ne doit &ecirc;tre de longueur fixe.</td></tr></tbody></table></div><br \="">
<br \="">
L'initialisation d'une d&eacute;finition de <tt><b>Type</b></tt> dans une instruction <tt><b>Dim</b></tt> est utile lorsque vous devez disposer d'un ensemble de valeurs initiales pour un <tt><b>Type</b></tt>, ou de valeurs qui ne changent pas au cours de l'ex&eacute;cution du programme. Comme les valeurs sont connues au moment de la compilation, le compilateur n'a pas &agrave; perdre des cycles de chargement des valeurs pendant l'ex&eacute;cution.<br \="">
<br \="">
<div class="fb_header"> Unions </div><br \="">
<br \="">
Les <tt><b>Union</b></tt>s sont similaires aux <tt><b>Type</b></tt>s dans leur d&eacute;finition.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Union</span>&nbsp;<span class="wrd">aUnion</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">b</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Byte</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">s</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Short</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
<span class="key">End</span>&nbsp;<span class="key">Union</span><br>
</div></tt><br>
<br \="">
S'il s'agissait d'un <tt><b>Type</b></tt>, vous pourriez acc&eacute;der &agrave; chaque champ de la d&eacute;finition. Pour une <tt><b>Union</b></tt> cependant, vous ne pouvez acc&eacute;der qu'&agrave; un seul champ &agrave; un moment donn&eacute;; tous les champs au sein d'une <tt><b>Union</b></tt> occupent le m&ecirc;me segment de m&eacute;moire et la taille de l'<tt><b>Union</b></tt> est la taille du membre le plus important. <br \="">
<br \="">
Dans ce cas, l'Union occupe quatre octets, la taille d'un <tt><b>Integer</b></tt>, avec le champ <i>b</i> occupant 1 octet, le champ <i>s</i> occupant 2 octets et le champ <i>i</i> occupant compl&egrave;tement les 4 octets. Chaque champ commence au premier octet, de sorte que le champ <i>s</i> inclurait les champs <i>b</i>, et le champ <i>i</i> inclurait les deux champs <i>b</i> et <i>s</i>.<br \="">
<br \="">
<div class="fb_header"> Des Types dans des Unions </div><br \="">
<br \="">
Un bon exemple d'utilisation d'une d&eacute;finition de <tt><b>Type</b></tt> dans une <tt><b>Union</b></tt> est la d&eacute;finition de <tt><i>Large_Integer</i></tt> dans <tt><i>winnt.bi</i></tt>. Le type de donn&eacute;e <tt><i>Large_Integer</i></tt> est utilis&eacute; dans de nombreuses fonctions Windows au sein de la biblioth&egrave;que C Runtime. L'extrait de code suivant montre la d&eacute;finition de <tt><i>Large_Integer</i></tt>.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Union</span>&nbsp;<span class="wrd">LARGE_INTEGER</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Type</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">LowPart</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">DWORD</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">HighPart</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Long</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">Type</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">QuadPart</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">LONGLONG</span><br>
<span class="key">End</span>&nbsp;<span class="key">Union</span><br>
</div></tt><br>
<br \="">
Le type de donn&eacute;es <tt><i>Dword</i></tt> est d&eacute;fini dans <tt><i>windef.bi</i></tt> comme un <tt><i>Uinteger</i></tt> FreeBasic et le type <tt><i>Longlong</i></tt> est d&eacute;fini comme un <tt><i>Longint</i></tt>. Un <tt><i>Long</i></tt> est seulement un alias pour le type de donn&eacute;es <tt><i>Integer</i></tt>. Souvenez-vous qu'un type occupe des emplacements de m&eacute;moire contigus, de sorte que le champ <tt><i>HighPart</i></tt> suit le champ <tt><i>LowPart</i></tt> en m&eacute;moire. Comme il s'agit d'une <tt><b>Union</b></tt>, le type occupe le m&ecirc;me segment de m&eacute;moire m&ecirc;me que le champ. <br \=""> 
<br \="">
Lorsque vous mettez une grande valeur enti&egrave;re dans <tt><i>QuardPart</i></tt>, vous d&eacute;finissez aussi en m&ecirc;me temps les valeurs des champs du <tt><b>Type</b></tt>, que vous pouvez ensuite extraire comme <tt><i>LowPart</i></tt> et <tt><i>HighPart</i></tt>. Vous pouvez aussi faire l'inverse; en d&eacute;finissant <tt><i>LowPart</i></tt> et <tt><i>HighPart</i></tt> du <tt><b>Type</b></tt>, vous d&eacute;finissez aussi la valeur du champ <tt><i>QuardPart</i></tt>.<br \="">
<br \="">
Comme vous pouvez le voir, utiliser un <tt><b>Type</b></tt> dans une <tt><b>Union</b></tt> est un moyen facile de d&eacute;finir ou de r&eacute;cup&eacute;rer des valeurs individuelles d'un composant <tt><b>Type</b></tt> de donn&eacute;es sans avoir recours &agrave; beaucoup de code de conversion. La disposition des segments de m&eacute;moire effectue la conversion pour vous, &agrave; condition que les segments de m&eacute;moire aient un sens dans le contexte du composant <tt><b>Type</b></tt>. <br \="">
<br \="">
Dans le cas de <tt><i>Large_Integer</i></tt>, <tt><i>LowPart</i></tt> et <tt><i>HighPart</i></tt> ont &eacute;t&eacute; d&eacute;finis pour renvoyer les valeurs appropri&eacute;es du composant. L'utilisation de valeurs autres que <tt><i>Dword</i></tt> et <tt><i>Long</i></tt> ne retournera pas de valeurs correctes pour <tt><i>LowPart</i></tt> et <tt><i>HighPart</i></tt>. Vous devez vous assurer que lorsque vous d&eacute;finissez un <tt><b>Type</b></tt> dans une <tt><b>Union</b></tt> que vous segmentez correctement la m&eacute;moire du segment <tt><b>Union</b></tt> dans la d&eacute;finition du <tt><b>Type</b></tt>.<br \="">
<br \="">
<div class="fb_header"> Unions dans les Types </div><br \="">
<br \="">
Une <tt><b>Union</b></tt> dans une d&eacute;finition de <tt><b>Type</b></tt>  est un moyen efficace pour g&eacute;rer les donn&eacute;es quand un champ dans un <tt><b>Type</b></tt> ne peut avoir qu'une seule de plusieurs valeurs. L'exemple le plus courant est le type de donn&eacute;es <tt><i>Variant</i></tt> dans d'autres langages de programmation.<br \="">
<br \="">
<div class="fb_table"><table><tbody><tr><td>FreeBasic n'a pas de type de donn&eacute;es <tt><i>Variant</i></tt> natif pour le moment. Cependant, en utilisant la syntaxe &eacute;tendue de <tt><b>Type</b></tt>, vous pouvez cr&eacute;er un type de donn&eacute;es <tt><i>Variant</i></tt> pour l'utiliser dans vos programmes.</td></tr></tbody></table></div><br \="">
<br \="">
Lorsque vous utilisez une <tt><b>Union</b></tt> dans un <tt><b>Type</b></tt>, une pratique courante est de cr&eacute;er un champ <tt><i>id</i></tt> dans le <tt><b>Type</b></tt> qui indique ce que l'<tt><b>Union</b></tt> contient &agrave; un moment donn&eacute;. L'extrait de code suivant illustre ce concept.<br \="">
<br \="">
<tt><div class="freebasic">
<span class="com">'Union&nbsp;field&nbsp;ids</span><br>
<span class="def">#define&nbsp;vInteger&nbsp;0<br>
#define&nbsp;vDouble&nbsp;1<br>
</span><br>
<span class="com">'Define&nbsp;type&nbsp;def&nbsp;with&nbsp;variable&nbsp;data&nbsp;fields</span><br>
<span class="key">Type</span>&nbsp;<span class="wrd">vType</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">vt_id</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Union</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">d</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Double</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">Union</span><br>
<span class="key">End</span>&nbsp;<span class="key">Type</span><br>
</div></tt><br>
<br \="">
La d&eacute;finition de l'<tt><b>Union</b></tt> ici est appel&eacute;e une <tt><b>Union</b></tt> anonyme car elle n'est pas d&eacute;finie avec un nom. Le champ <i>vt_id</i> de la d&eacute;finition du <tt><b>Type</b></tt> indique la valeur de l'<tt><b>Union</b></tt>. Pour initialiser le type vous devez utiliser le code suivant:<br \="">
<br \="">
<tt><div class="freebasic">
<span class="key">Dim</span>&nbsp;<span class="wrd">myVarianti</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">vType</span><br>
<span class="key">Dim</span>&nbsp;<span class="wrd">myVariantd</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">vType</span><br>
<br>
<span class="wrd">myVarianti.vt_id</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">vInteger</span><br>
<span class="wrd">myVarianti.i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">300</span><br>
<br>
<span class="wrd">myVariantd.vt_id</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">vDouble</span><br>
<span class="wrd">myVariantd.d</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">356.56</span><br>
</div></tt><br>
<br \="">
<i>myVarianti</i> contient une valeur enti&egrave;re donc l'<i>id</i> est mis &agrave; <i>vInteger</i>. <i>myVariantd</i> contient une valeur <i>double</i> donc l'<i>id</i> est mis &agrave; <i>vDouble</i>. Si vous cr&eacute;ez une sous-routine qui a un param&egrave;tre <i>vType</i>, vous pouvez examiner le champ <i>vt_type</i> pour d&eacute;terminer si c'est un nombre entier ou double qui a &eacute;t&eacute; pass&eacute; &agrave; la sous-routine.<br \="">
<br \="">
<div class="fb_table"><table><tbody><tr><td> Vous ne pouvez pas utiliser des cha&icirc;nes de dynamiques au sein d'une <tt><b>Union</b></tt>.</td></tr></tbody></table></div><br \="">
<br \="">
Utiliser une combinaison d'<tt><b>Union</b></tt>s et de <tt><b>Type</b></tt>s dans un programme vous permet de concevoir des types de donn&eacute;es qui ont beaucoup de souplesse, mais il faut veiller &agrave; utiliser correctement les donn&eacute;es construites. Une mauvaise utilisation de ces types de donn&eacute;es peut entra&icirc;ner des bogues tr&egrave;s difficiles &agrave; trouver. Les avantages toutefois, l'emportent sur les risques et une fois ma&icirc;tris&eacute;s, ce sont des outils de programmation puissants.<br \="">

</div>
</div> 
</div> 
</body></html>