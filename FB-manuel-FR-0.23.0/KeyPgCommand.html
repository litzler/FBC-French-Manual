<html>
<head>
<title>Command</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Command</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Renvoie les paramètres de la ligne de commande utilisés pour appeler le programme<br \>
<br \>
<div class="fb_sect_title">Syntaxe</div><div class="fb_sect_cont"><tt><br \>
<a href="KeyPgDeclare.html">Declare</a> <a href="KeyPgFunction.html">Function</a> <b>Command</b> ( <a href="KeyPgByval.html">ByVal</a> <i>index</i> <a href="KeyPgAs.html">As</a> <a href="KeyPgInteger.html">Integer</a> = -1 ) <a href="KeyPgAs.html">As</a> <a href="KeyPgString.html">String</a><br \>
</tt><br \>
</div><div class="fb_sect_title">Usage</div><div class="fb_sect_cont"><tt><br \>
<i>result</i> = <b>Command</b>[$]( [ <i>index</i> ] )<br \>
</tt><br \>
</div><div class="fb_sect_title">Paramètres</div><div class="fb_sect_cont"><br \>
<tt><i>index</i></tt><br \>
<div class="fb_indent">Indice (de base zéro) pour un argument particulier de la ligne de commande.<br \>
<br \>
</div></div><div class="fb_sect_title">Valeur retournée</div><div class="fb_sect_cont"><br \>
  Retourne le(s) arguments(s)de ligne de commande.<br \>
<br \>
</div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
<tt><b>Command</b></tt> retourne le(s) arguments(s)de ligne de commande passés au programme lors de l'exécution.<br \>
<br \>
Si <tt><i>index</i></tt> est inférieur &agrave; zéro (<tt>&lt; 0</tt>), une liste de tous les arguments (séparés par des epaces) de la ligne de commande est retournée, autrement, un argument unique est retourné. Une valeur de zéro (<tt>0</tt>) retourne le nom de l'exécutable; et une valeur de un (<tt>1</tt>) et supérieure retourne chaque argument de la ligne de commande.<br \>
<br \>
Si <tt><i>index</i></tt> est supérieur au nombre d'arguments passés au programme, la chaîne nulle <tt>"</tt><tt>"</tt>) est retournée.<br \>
<br \>
Lorsque la ligne de commande est analysée pour les arguments, ce qui est entre guillemets dans la liste des paramètres sera considéré comme un seul paramètre, et est retourné avec les guillemets.<br \>
<br \>
Par défaut, le nom de fichier avec "globbing" (expansion des jokers pour les noms de fichiers) pour les arguments est utilisé sur tous les portages de FreeBasic pour la compatibilité.  Les arguments sur la ligne de commande contenant des jokers ne sont généralement pas expansés si aucun fichier ne correspond ou n'est correctement déclaré.  Les autres caractères spéciaux pour la redirection ne sont généralement pas retournés sauf si correctement déclarés.  Consultez la documentation sur l'interpréteur de commandes (shell) utilisé pour plus d'informations sur la déclaration convenable des arguments de la ligne de commande.<br \>
<br \>
<i><b>AVERTISSEMENT</b>: Par la nature de la priorité de constructeur sous FreeBASIC et initialisation de main(), appeler <tt><b>Command</b></tt> dans un constructeur global n'est pas s&ucirc;r. Sur le moment, votre application ne plantera pas, mais vous ne recevrez que la chaîne nulle (<tt>"</tt><tt>"</tt>). Ceci sera *peut &ecirc;tre* corrigé &agrave; l'avenir, mais il serait sage de ne pas trop y croire.</i><br \>
<br \>
<u>Désactivation de "globbing" de nom de fichier sous Win32</u><br \>
<div class="fb_indent">Pour les constructions mingw32 et cygwin builds, lier le programme FreeBASIC avec CRT_noglob.o ou définir ce qui suit quelque part dans la source:<br \>
<tt><div class="freebasic">
<span class="key">Extern</span>&nbsp;<span class="wrd">_CRT_glob</span>&nbsp;<span class="key">Alias</span>&nbsp;<span class="quo">"_CRT_glob"</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<span class="key">Dim</span>&nbsp;<span class="key">Shared</span>&nbsp;<span class="wrd">_CRT_glob</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
</div></tt><br />
<br \>
</div><u>Désactivation du "globbing" de nom de fichier sous Dos</u><br \>
<div class="fb_indent">Définir la fonction suivante quelque part dans la source:<br \>
<tt><div class="freebasic">
<span class="key">Public</span>&nbsp;<span class="key">Function</span>&nbsp;<span class="wrd">__crt0_glob_function</span>&nbsp;<span class="key">Alias</span>&nbsp;<span class="quo">"__crt0_glob_function"</span>&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">arg</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">UByte</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">UByte</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="key">Ptr</span><br />
&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="num">0</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
</div></tt><br />
<br \>
</div><u>Désactivation du "globbing" de nom de fichier sous Linux</u><br \>
<div class="fb_indent">Le "globbing" de nom de fichier  est géré par l'interpréteur de commandes (shell).  Mettre entre guillemets l'argument contenant des jokers ou désactiver le "globbing" de nom de fichier dans le shell avant l'exécution de la commande.  Par exemple dans l'interpréteur de commandes bash utilisez 'set -f' pour désactiver l'expansion des jokers. <br \>
<br \>
</div></div><div class="fb_sect_title">Exemple</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="com">''</span><br />
<span class="com">''&nbsp;command-line&nbsp;arguments&nbsp;example</span><br />
<span class="com">''</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"exe&nbsp;name=&nbsp;"</span><span class="oth">;</span>&nbsp;<span class="key">Command</span><span class="oth">(</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">)</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">argc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">argc</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Do</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">argv</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Command</span><span class="oth">(</span>&nbsp;<span class="wrd">argc</span>&nbsp;<span class="oth">)</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span><span class="oth">(</span>&nbsp;<span class="key">Len</span><span class="oth">(</span>&nbsp;<span class="wrd">argv</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Exit</span>&nbsp;<span class="key">Do</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"arg"</span><span class="oth">;</span>&nbsp;<span class="wrd">argc</span><span class="oth">;</span>&nbsp;<span class="quo">"&nbsp;=&nbsp;"""</span><span class="oth">;</span>&nbsp;<span class="wrd">argv</span><span class="oth">;</span>&nbsp;<span class="quo">""""</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">argc</span>&nbsp;<span class="oth">+=</span>&nbsp;<span class="num">1</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Loop</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span><span class="oth">(</span>&nbsp;<span class="wrd">argc</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"(no&nbsp;arguments)"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;complete&nbsp;list:&nbsp;"</span><span class="oth">;</span><span class="key">Command</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Diff&eacute;rences de dialecte</div><div class="fb_sect_cont"><br \>
<ul><li> Le suffixe de type chaîne <tt>$</tt> est obligatoire dans le dialecte <i><a href="CompilerOptlang.html">-lang qb</a></i>.<br \>
<li> Le suffixe de type chaîne <tt>$</tt> est facultatif dans les dialectes <i><a href="CompilerOptlang.html">-lang fblite</a></i> et <i><a href="CompilerOptlang.html">-lang fb</a></i>.<br \>
<br \>
</ul></div><div class="fb_sect_title">Diff&eacute;rences avec QB</div><div class="fb_sect_cont"><br \>
<ul><li> L'argument numérique n'était pas pris en charge dans QB.<br \>
<li> QB convertit la liste de param&egrave;tres en majuscules avant de la retourner, FreeBASIC non.<br \>
<li> Par défaut les arguments contenant des caract&egrave;res g&eacute;n&eacute;riques sont d&eacute;velopp&eacute;s ("globbing" des noms de fichiers)<br \>
<br \>
</ul></div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgDdfbargc.html">__FB_ARGC__</a></tt><br \>
<li> <tt><a href="KeyPgDdfbargv.html">__FB_ARGV__</a></tt><br \>
<li> <tt><a href="KeyPgExec.html">Exec</a></tt><br \>
<li> <tt><a href="KeyPgRun.html">Run</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
