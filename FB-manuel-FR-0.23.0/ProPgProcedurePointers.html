<html>
<head>
<title>Pointers to Procedures</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Pointeurs vers des proc&eacute;dures</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Pointeurs qui pointent vers des proc&eacute;dures<br \>
<br \>
Tout comme les pointeurs peuvent &ecirc;tre faits pour pointer vers un type <tt><a href="KeyPgInteger.html">Integer</a></tt> ou <tt><a href="KeyPgSingle.html">Single</a></tt>, les pointeurs peuvent aussi pointer vers des proc&eacute;dures, c'est &agrave; dire qu'ils peuvent stocker l'adresse d'une proc&eacute;dure.<br \>
<br \>
<div class="fb_sect_title">D&eacute;claration</div><div class="fb_sect_cont"><br \>
Pour d&eacute;clarer un pointeur vers une proc&eacute;dure, utilisez les mots-clefs <tt><a href="KeyPgSub.html">Sub</a></tt> ou <tt><a href="KeyPgFunction.html">Function</a></tt>, suivi de param&egrave;tres et du type de la valeur de retour:<br \>
<br \>
<tt><div class="freebasic">
<span class="com">'&nbsp;d&eacute;clare&nbsp;un&nbsp;pointeur&nbsp;vers&nbsp;une&nbsp;proc&eacute;dure&nbsp;Sub&nbsp;qui&nbsp;n'a&nbsp;aucun&nbsp;argument</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">pointerToProcedure</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Sub</span><br />
</div></tt><br />
Les pointeurs de proc&eacute;dure stockent l'adresse de la proc&eacute;dure, qui est r&eacute;cup&eacute;r&eacute;e &agrave; l'aide de <tt><a href="KeyPgOpAt.html">Operator @</a></tt> (Adresse de) ou de <tt><a href="KeyPgOpProcptr.html">Procptr Operator</a></tt>:<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Function</span>&nbsp;<span class="wrd">Add</span>&nbsp;<span class="oth">(</span><span class="wrd">a</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">b</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">a</span>&nbsp;<span class="oth">+</span>&nbsp;<span class="wrd">b</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">pFunc</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">(</span><span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">@</span><span class="wrd">Add</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Appel d'un pointeur de proc&eacute;dure</div><div class="fb_sect_cont"><br \>
La chose int&eacute;ressante &agrave; propos des pointeurs proc&eacute;dure est qu'ils peuvent &ecirc;tre appel&eacute;s tout comme une proc&eacute;dure:<br \>
<br \>
<tt><div class="freebasic">
<span class="com">''&nbsp;..&nbsp;Add&nbsp;et&nbsp;pFunc&nbsp;comme&nbsp;avant&nbsp;..</span><br />
<span class="def">#include&nbsp;once&nbsp;"pfunc.bi"<br />
</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">"3&nbsp;+&nbsp;4&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">pFunc</span><span class="oth">(</span><span class="num">3</span><span class="oth">,</span>&nbsp;<span class="num">4</span><span class="oth">)</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Passage de pointeur de proc&eacute;dure &agrave; d'autres proc&eacute;dures</div><div class="fb_sect_cont"><br \>
Passage de pointeurs de proc&eacute;dure &agrave; d'autres proc&eacute;dures est similaires &agrave;:<br \>
<br \>
<tt><div class="freebasic">
<span class="com">''&nbsp;..&nbsp;Add&nbsp;et&nbsp;pFunc&nbsp;comme&nbsp;avant&nbsp;..</span><br />
<span class="def">#include&nbsp;once&nbsp;"pfunc.bi"<br />
</span><br />
<span class="key">Function</span>&nbsp;<span class="wrd">DoOperation</span>&nbsp;<span class="oth">(</span><span class="wrd">a</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">b</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">operation</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">(</span><span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">operation</span><span class="oth">(</span><span class="wrd">a</span><span class="oth">,</span>&nbsp;<span class="wrd">b</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="quo">"3&nbsp;+&nbsp;4&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">DoOperation</span><span class="oth">(</span><span class="num">3</span><span class="oth">,</span>&nbsp;<span class="num">4</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="wrd">Add</span><span class="oth">)</span><br />
</div></tt><br />
Parce que les d&eacute;clarations de pointeur de proc&eacute;dure peuvent &ecirc;tre longues, il est souvent utile de cr&eacute;er un alias de type pour le pointeur de proc&eacute;dure, dans un effort de clarification du code:<br \>
<br \>
<tt><div class="freebasic">
<span class="com">''&nbsp;..&nbsp;Add&nbsp;et&nbsp;pFunc&nbsp;comme&nbsp;avant&nbsp;..</span><br />
<span class="def">#include&nbsp;once&nbsp;"pfunc.bi"<br />
</span><br />
<span class="key">Type</span>&nbsp;<span class="wrd">operation</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">(</span><span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<br />
<span class="key">Function</span>&nbsp;<span class="wrd">DoOperation</span>&nbsp;<span class="oth">(</span><span class="wrd">a</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">b</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">op</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">operation</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Return</span>&nbsp;<span class="wrd">op</span><span class="oth">(</span><span class="wrd">a</span><span class="oth">,</span>&nbsp;<span class="wrd">b</span><span class="oth">)</span><br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="quo">"3&nbsp;+&nbsp;4&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">DoOperation</span><span class="oth">(</span><span class="num">3</span><span class="oth">,</span>&nbsp;<span class="num">4</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="wrd">Add</span><span class="oth">)</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Pointeurs de pointeurs de proc&eacute;dure</div><div class="fb_sect_cont"><br \>
Parce que la syntaxe d'un pointeur de proc&eacute;dure ne permet pas de d&eacute;claration d'un pointeur vers un pointeur de proc&eacute;dure, un alias de type est utilis&eacute;. Notez comment il est n&eacute;cessaire d'entourer un pointeur d&eacute;r&eacute;f&eacute;renc&eacute; vers un pointeur de proc&eacute;dure par des parenth&egrave;ses lors de l'appel de la proc&eacute;dure. C'est parce que l'op&eacute;rateur d'appel de fonction "()" a une priorit&eacute; sup&eacute;rieure &agrave; <tt><a href="KeyPgOpValueOf.html">Operator *</a></tt> (Valeur de):<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">Halve</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">/=</span>&nbsp;<span class="num">2</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Sub</span>&nbsp;<span class="wrd">Triple</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">*=</span>&nbsp;<span class="num">3</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Type</span>&nbsp;<span class="wrd">operation</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Sub</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
<br />
<span class="com">'&nbsp;an&nbsp;array&nbsp;of&nbsp;procedure&nbsp;pointers,&nbsp;NULL&nbsp;indicates&nbsp;the</span><br />
<span class="com">'&nbsp;end&nbsp;of&nbsp;the&nbsp;array</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">operations</span><span class="oth">(</span><span class="num">20</span><span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">operation</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">_</span><br />
<span class="oth">{</span>&nbsp;<span class="oth">@</span><span class="wrd">Halve</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="wrd">Triple</span><span class="oth">,</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">}</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">280</span><br />
<br />
<span class="com">'&nbsp;apply&nbsp;all&nbsp;of&nbsp;the&nbsp;operations&nbsp;to&nbsp;a&nbsp;variable&nbsp;by&nbsp;iterating&nbsp;through&nbsp;the&nbsp;array</span><br />
<span class="com">'&nbsp;with&nbsp;a&nbsp;pointer&nbsp;to&nbsp;procedure&nbsp;pointer</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">op</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">operation</span>&nbsp;<span class="key">Ptr</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">@</span><span class="wrd">operations</span><span class="oth">(</span><span class="num">0</span><span class="oth">)</span><br />
<span class="key">While</span>&nbsp;<span class="oth">(</span><span class="num">0</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="oth">*</span><span class="wrd">op</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'&nbsp;call&nbsp;the&nbsp;procedure&nbsp;that&nbsp;is&nbsp;pointed&nbsp;to,&nbsp;note&nbsp;the&nbsp;extra&nbsp;parenthesis</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">(*</span><span class="wrd">op</span><span class="oth">)(</span><span class="wrd">i</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">op</span>&nbsp;<span class="oth">+=</span>&nbsp;<span class="num">1</span><br />
<span class="key">Wend</span><br />
<br />
<span class="key">Print</span>&nbsp;<span class="quo">"Value&nbsp;of&nbsp;'i'&nbsp;after&nbsp;all&nbsp;operations&nbsp;performed:&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">i</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgSub.html">Sub</a></tt><br \>
<li> <tt><a href="KeyPgFunction.html">Function</a></tt><br \>
<li> <tt><a href="KeyPgPointer.html">Pointer</a></tt><br \>
<li> <tt><a href="KeyPgOpAt.html">Op&eacute;rateur * (Adresse de)</a></tt><br \>
<li> <tt><a href="KeyPgOpProcptr.html">Procptr Operator</a></tt><br \>
<br \>
</ul><br \>
   <br \>
<br \>
   <br \>
<br \>
   <br \>
</div>
</div>
</div> 
</div> 
</body>
</html>
