<html>
<head>
<title>Introduction to Message-Based Programming</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Introduction to Message-Based Programming</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	<i>Written by <a href="WikiRick.html">rdc</a></i><br \>
<br \>
Historiquement, les langages de programmation ont &eacute;t&eacute; class&eacute;s comme &eacute;tant bas&eacute;s sur les proc&eacute;dures et sur les messages. Par exemple, QuickBasic peut &ecirc;tre class&eacute; comme un langage proc&eacute;dural et Visual Basic peut &ecirc;tre class&eacute; comme bas&eacute; sur les messages (ou &eacute;v&eacute;nementiel). Dans un langage proc&eacute;dural vous commencez g&eacute;n&eacute;ralement par le haut, faites quelque chose et sortez d'une mani&egrave;re plut&ocirc;t lin&eacute;aire. Dans un langage bas&eacute; sur les messages, vous devez g&eacute;n&eacute;ralement initialiser le syst&egrave;me, puis le programme se trouve dans une boucle d'inactivit&eacute; et attend que quelque chose se produise. Lorsque quelque chose se produit, vous l'utilisez, puis le programme retourne &agrave; la boucle d'inactivit&eacute;, finalement on sort de la boucle lorsque l'utilisateur ferme le programme.<br \>
<br \>
Dans un langage proc&eacute;dural vous avez le plein contr&ocirc;le sur ce que l'utilisateur voit et fait. Dans sur le syst&egrave;me bas&eacute; sur les messages, vous travaillez en collaboration avec le syst&egrave;me d'exploitation et l'utilisateur, ne manipulant que les messages qui vous int&eacute;ressent, et laissant le syst&egrave;me d'exploitation g&eacute;rer le reste. La v&eacute;ritable pierre d'achoppement pour les programmeurs qui viennent &agrave; un langage bas&eacute; sur les messages &agrave; partir d'un langage proc&eacute;dural, est le concept de ne r&eacute;pondre qu'aux messages. Cependant, nous parlons en r&eacute;alit&eacute; plut&ocirc;t dans des nuances de gris plut&ocirc;t qu'en noir et blanc. Dans la plupart des langages, y compris proc&eacute;duraux, les messages jouent un r&ocirc;le important.<br \>
<br \>
Si vous avez d&eacute;j&agrave; utilis&eacute; un langage qui prend en charge les appels de sous-programmes et de fonctions, alors vous avez utilis&eacute; la programmation bas&eacute;e sur les messages. Par exemple, disons que vous avez &eacute;crit un jeu en QuickBasic qui se trouve dans une boucle qui attend qu'une des touches fl&eacute;ch&eacute;es soit appuy&eacute;e. Si la touche fl&egrave;che vers le haut est appuy&eacute;e, vous appelez un sous-programme qui met &agrave; jour la position d'un sprite sur l'&eacute;cran. Si la touche A est press&eacute;e, vous l'ignorez, puisque vous ne vous en pr&eacute;occupez pas. C'est de la programmation bas&eacute;e sur les messages. Le message est "Appuyer sur la touche" et le sous-programme de mise &agrave; jour du sprite est le gestionnaire de messages. <br \>
<br \>
Tout langage de programmation structur&eacute; peut &ecirc;tre class&eacute; comme un langage de programmation bas&eacute; sur les messages. La programmation bas&eacute;e sur stte entr&eacute;es. Il est m&eacute;thodologique c'est un type de langage. Il est devenu la caract&eacute;ristique dominante de certains langages de programmation quand les syst&egrave;mes d'exploitation ont &eacute;volu&eacute; de la ligne de commande &agrave; des interfaces utilisateur graphiques (GUI). <br \>
<br \>
Dans un syst&egrave;me d'exploitation bas&eacute; sur des GUI, tels que Windows, le syst&egrave;me d'exploitation g&egrave;re l'ensemble des &eacute;l&eacute;ments graphiques en interne. Comme le programmeur ne doit pas construire un champ d'&eacute;dition de texte en partant de z&eacute;ro, il / elle a juste &agrave; utiliser le champ de saisie int&eacute;gr&eacute; dans le shell graphique, il devait y avoir un moyen d'informer le programmeur que l'utilisateur veut mettre &agrave; jour le champ d'&eacute;dition. La m&eacute;thode la plus naturelle consiste &agrave; envoyer un message au programme indiquant que le champ d'&eacute;dition a &eacute;t&eacute; mis &agrave; jour. Sous Windows, cet emprunt d'&eacute;l&eacute;ments GUI et la r&eacute;ception de messages a &eacute;t&eacute; formalis&eacute; dans ce qu'on appelle le kit de d&eacute;veloppement Windows Software, ou plus commun&eacute;ment, le SDK Windows.<br \>
<br \>
Le SDK Windows est une collection d'interfaces de programmation d'applications (API) dans un ensemble de biblioth&egrave;ques de liens dynamiques (DLL) qui forment la majorit&eacute; du syst&egrave;me d'exploitation. Tout programme GUI sous Windows utilise le SDK, m&ecirc;me si cela n'est pas apparent. En d&eacute;veloppement rapide d'applications (RAD) des langages tels que Delphi, Visual Basic ou Real Basic, ces langages masquent les d&eacute;tails du SDK en utilisant les propri&eacute;t&eacute;s et les &eacute;v&eacute;nements, mais sous le capot, ils utilisent le SDK.<br \>
<br \>
Alors que les langages RAD permettent au programmeur de construire rapidement une interface graphique &agrave; base de programmes, cela signifie aussi que les d&eacute;tails les plus fins du SDK ne sont pas accessibles. Par exemple, il est tr&egrave;s difficile de sous-classer un contr&ocirc;le en utilisant VB, mais il est assez simple en utilisant le SDK. Toutefois, le SDK est &eacute;norme, et la taille de cisaillement de l'API suffit &agrave; faire que de nombreux programmeurs renoncent &agrave; l'id&eacute;e de la programmation avec SDK. La pens&eacute;e commune, c'est qu'il est trop compliqu&eacute; et difficile &agrave; utiliser, mais l'inverse est vrai. Parce que le syst&egrave;me d'exploitation g&egrave;re tous les &eacute;l&eacute;ments graphiques pour le programme, le programmeur peut se concentrer sur l'aspect le plus important de la conception du programme, l'interaction avec l'utilisateur. Apr&egrave;s tout,  le sujet d'un programme GUI c'est l'interaction avece l'utilisateur.<br \>
<br \>
FreeBASIC n'a pas de syst&egrave;me RAD pour la programmation Windows. Pour cr&eacute;er un programme Windows dans FreeBasic, vous aurez &agrave; utiliser le SDK, car c'est la seule option. Alors que le SDK est immense, et qu'il faudrait probablement prendre toute une vie pour bien le comprendre, pour 99% de tous les programmes Windows, seul un petit sous-ensemble du SDK doit &ecirc;tre utilis&eacute;. La r&eacute;alit&eacute; est que la programmation avec SDK Windows n'est pas plus difficile que n'importe quel autre type de programmation, et pour l'interface graphique &agrave; base de programmes, est plus facile qu'un langage o&ugrave; vous auriez &agrave; cr&eacute;er tous les &eacute;l&eacute;ments de l'interface vous-m&ecirc;me.<br \>
<br \>
En mettant de c&ocirc;t&eacute; tous les petits d&eacute;tails de l'API Windows pour le moment, il est important de comprendre le m&eacute;canisme des messages &agrave; un programme SDK. La meilleure solution est d'examiner notre vieil ami, le programme "Bonjour tout le monde". Dans les exemples du dossier "\Windows\gui" de la distribution de 0,15 FreeBasic b (qui est n&eacute;cessaire pour le code dans cet article), il s'agit d'un programme mondial "Bonjour tout le monde" que je vais voler - je veux dire emprunter, comme la base de cette exemple.<br \>
<br \>
<tt><tt><div class="FreeBASIC">
<span class="key">Option</span>&nbsp;<span class="key">Explicit</span><br />
<span class="key">Option</span>&nbsp;<span class="key">Private</span><br />
<br />
<span class="def">#include&nbsp;once&nbsp;"windows.bi"<br />
</span><br />
<span class="key">Declare</span>&nbsp;<span class="key">Function</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">WinMain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">hInstance</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HINSTANCE</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">hPrevInstance</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HINSTANCE</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">szCmdLine</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">iCmdShow</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Entry&nbsp;point&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="wrd">WinMain</span><span class="oth">(</span>&nbsp;<span class="wrd">GetModuleHandle</span><span class="oth">(</span>&nbsp;<span class="wrd">null</span>&nbsp;<span class="oth">),</span>&nbsp;<span class="wrd">null</span><span class="oth">,</span>&nbsp;<span class="key">Command$</span><span class="oth">,</span>&nbsp;<span class="wrd">SW_NORMAL</span>&nbsp;<span class="oth">)</span><br />
<br />
<span class="com">''&nbsp;::::::::</span><br />
<span class="com">''&nbsp;name:&nbsp;WndProc</span><br />
<span class="com">''&nbsp;desc:&nbsp;Processes&nbsp;windows&nbsp;messages</span><br />
<span class="com">''</span><br />
<span class="com">''&nbsp;::::::::</span><br />
<span class="key">Function</span>&nbsp;<span class="wrd">WndProc</span>&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">hWnd</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HWND</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">message</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UINT</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">wParam</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">WPARAM</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">lParam</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">LPARAM</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">LRESULT</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Process&nbsp;messages</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Select</span>&nbsp;<span class="key">Case</span><span class="oth">(</span>&nbsp;<span class="wrd">message</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Window&nbsp;was&nbsp;created</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="wrd">WM_CREATE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Exit</span>&nbsp;<span class="key">Function</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;User&nbsp;clicked&nbsp;the&nbsp;form</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="wrd">WM_LBUTTONUP</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">MessageBox</span>&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="quo">"Hello&nbsp;world&nbsp;from&nbsp;FreeBASIC"</span><span class="oth">,</span>&nbsp;<span class="quo">"FB&nbsp;Win"</span><span class="oth">,</span>&nbsp;<span class="wrd">MB_OK</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Windows&nbsp;is&nbsp;being&nbsp;repainted</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="wrd">WM_PAINT</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">rct</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">RECT</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">pnt</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">PAINTSTRUCT</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">hDC</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HDC</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">hDC</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">BeginPaint</span><span class="oth">(</span>&nbsp;<span class="wrd">hWnd</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="wrd">pnt</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">GetClientRect</span><span class="oth">(</span>&nbsp;<span class="wrd">hWnd</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="wrd">rct</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">DrawText</span><span class="oth">(</span>&nbsp;<span class="wrd">hDC</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="quo">"Hello&nbsp;Windows&nbsp;from&nbsp;FreeBASIC!"</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">-</span><span class="num">1</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">@</span><span class="wrd">rct</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">DT_SINGLELINE</span>&nbsp;<span class="key">Or</span>&nbsp;<span class="wrd">DT_CENTER</span>&nbsp;<span class="key">Or</span>&nbsp;<span class="wrd">DT_VCENTER</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">EndPaint</span><span class="oth">(</span>&nbsp;<span class="wrd">hWnd</span><span class="oth">,</span>&nbsp;<span class="oth">@</span><span class="wrd">pnt</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Exit</span>&nbsp;<span class="key">Function</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Key&nbsp;pressed</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="wrd">WM_KEYDOWN</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">'Close&nbsp;if&nbsp;esc&nbsp;key&nbsp;pressed</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span><span class="oth">(</span>&nbsp;<span class="key">LoByte</span><span class="oth">(</span>&nbsp;<span class="wrd">wParam</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">27</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">PostMessage</span><span class="oth">(</span>&nbsp;<span class="wrd">hWnd</span><span class="oth">,</span>&nbsp;<span class="wrd">WM_CLOSE</span><span class="oth">,</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Window&nbsp;was&nbsp;closed</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Case</span>&nbsp;<span class="wrd">WM_DESTROY</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">PostQuitMessage</span><span class="oth">(</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Exit</span>&nbsp;<span class="key">Function</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">Select</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Message&nbsp;doesn't&nbsp;concern&nbsp;us,&nbsp;send&nbsp;it&nbsp;to&nbsp;the&nbsp;default&nbsp;handler</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;and&nbsp;get&nbsp;result</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">DefWindowProc</span><span class="oth">(</span>&nbsp;<span class="wrd">hWnd</span><span class="oth">,</span>&nbsp;<span class="wrd">message</span><span class="oth">,</span>&nbsp;<span class="wrd">wParam</span><span class="oth">,</span>&nbsp;<span class="wrd">lParam</span>&nbsp;<span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
<br />
<span class="com">''&nbsp;::::::::</span><br />
<span class="com">''&nbsp;name:&nbsp;WinMain</span><br />
<span class="com">''&nbsp;desc:&nbsp;A&nbsp;win2&nbsp;gui&nbsp;program&nbsp;entry&nbsp;point</span><br />
<span class="com">''</span><br />
<span class="com">''&nbsp;::::::::</span><br />
<span class="key">Function</span>&nbsp;<span class="wrd">WinMain</span>&nbsp;<span class="oth">(</span>&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">hInstance</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HINSTANCE</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">hPrevInstance</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HINSTANCE</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">szCmdLine</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">ByVal</span>&nbsp;<span class="wrd">iCmdShow</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">wMsg</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">MSG</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">wcls</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">WNDCLASS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">szAppName</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Dim</span>&nbsp;<span class="wrd">hWnd</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HWND</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Setup&nbsp;window&nbsp;class</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">szAppName</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"HelloWin"</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">With</span>&nbsp;<span class="wrd">wcls</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">style</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">CS_HREDRAW</span>&nbsp;<span class="key">Or</span>&nbsp;<span class="wrd">CS_VREDRAW</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lpfnWndProc</span>&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">@</span><span class="wrd">WndProc</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">cbClsExtra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">cbWndExtra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hInstance</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">hInstance</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hIcon</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">LoadIcon</span><span class="oth">(</span>&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="wrd">IDI_APPLICATION</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hCursor</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">LoadCursor</span><span class="oth">(</span>&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="wrd">IDC_ARROW</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hbrBackground</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">GetStockObject</span><span class="oth">(</span>&nbsp;<span class="wrd">WHITE_BRUSH</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lpszMenuName</span>&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">NULL</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lpszClassName</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">StrPtr</span><span class="oth">(</span>&nbsp;<span class="wrd">szAppName</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">With</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Register&nbsp;the&nbsp;window&nbsp;class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">If</span><span class="oth">(</span>&nbsp;<span class="wrd">RegisterClass</span><span class="oth">(</span>&nbsp;<span class="oth">@</span><span class="wrd">wcls</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">FALSE</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="key">Then</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">MessageBox</span><span class="oth">(</span>&nbsp;<span class="wrd">null</span><span class="oth">,</span>&nbsp;<span class="quo">"Failed&nbsp;to&nbsp;register&nbsp;wcls!"</span><span class="oth">,</span>&nbsp;<span class="wrd">szAppName</span><span class="oth">,</span>&nbsp;<span class="wrd">MB_ICONERROR</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Exit</span>&nbsp;<span class="key">Function</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">If</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Create&nbsp;the&nbsp;window&nbsp;and&nbsp;show&nbsp;it</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">hWnd</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">CreateWindowEx</span><span class="oth">(</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">szAppName</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="quo">"The&nbsp;Hello&nbsp;Program"</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">WS_OVERLAPPEDWINDOW</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">CW_USEDEFAULT</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">CW_USEDEFAULT</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">CW_USEDEFAULT</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">CW_USEDEFAULT</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">hInstance</span><span class="oth">,</span>&nbsp;<span class="wrd">_</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">NULL</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">ShowWindow</span><span class="oth">(</span>&nbsp;<span class="wrd">hWnd</span><span class="oth">,</span>&nbsp;<span class="wrd">iCmdShow</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">UpdateWindow</span><span class="oth">(</span>&nbsp;<span class="wrd">hWnd</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Process&nbsp;windows&nbsp;messages</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">While</span><span class="oth">(</span>&nbsp;<span class="wrd">GetMessage</span><span class="oth">(</span>&nbsp;<span class="oth">@</span><span class="wrd">wMsg</span><span class="oth">,</span>&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="wrd">FALSE</span>&nbsp;<span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">TranslateMessage</span><span class="oth">(</span>&nbsp;<span class="oth">@</span><span class="wrd">wMsg</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">DispatchMessage</span><span class="oth">(</span>&nbsp;<span class="oth">@</span><span class="wrd">wMsg</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Wend</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Program&nbsp;has&nbsp;ended</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Function</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">wMsg.wParam</span><br />
<br />
<span class="key">End</span>&nbsp;<span class="key">Function</span><br />
</div></tt><br />
</tt><br \>
<br \>
Si vous avez compil&eacute; avec succ&egrave;s et ex&eacute;cut&eacute; le programme, vous verrez une fen&ecirc;tre standard avec un message affich&eacute; sur le formulaire. Si vous cliquez sur le formulaire, une bo&icirc;te de message s'affiche, et si vous appuyez sur la touche Echap, le programme se ferme. <br \>
<br \>
Prenez un moment pour examiner la fen&ecirc;tre. Vous verrez qu'elle a les boutons max, min et restaurer, un menu syst&egrave;me et peut &ecirc;tre redimensionn&eacute;e. Il n'y a pas de code n&eacute;cessaire pour g&eacute;rer les propri&eacute;t&eacute;s de la fen&ecirc;tre, le syst&egrave;me d'exploitation g&egrave;re tout cela pour vous. Cela ne prend &eacute;galement qu'une seule ligne de code pour afficher la messagebox, qui en soi, est un objet assez complexe. Le ratio de r&eacute;sultat &agrave; la quantit&eacute; de code, est tout &agrave; fait remarquable. Si vous deviez essayer de recr&eacute;er ce programme simple &agrave; l'aide des commandes graphiques standard de FreeBASIC, le programme serait cent fois plus grand.<br \>
<br \>
La premi&egrave;re chose que vous remarquerez sur le code ci-dessus est le format. C'est le format de base de tout programme de FreeBasic Windows. Chaque programme de Windows, quelle que soit sa simplicit&eacute; ou complexit&eacute;, suivra ce m&ecirc;me format de base. Les deux ingr&eacute;dients principaux de ce programme sont les proc&eacute;dures <b>WinMain</b> et <b>WinProc</b>.<br \>
<br \>
La proc&eacute;dure WinMain Windows est la proc&eacute;dure appel&eacute;e quand un programme est lanc&eacute;. Elle est le point d'entr&eacute;e d'un programme de Windows. Dans WinMain, vous construisez et vous inscrivez la fen&ecirc;tre principale du programme, puis vous entrez dans la boucle de message pour traiter les messages. Une fois que le programme entre dans la boucle de message, il va commencer le traitement des messages avec la proc&eacute;dure WinProc. Comme cet article porte sur le mod&egrave;le de message dans un programme Windows, nous ne parlerons seulement de la boucle de messages dans WinMain et de la proc&eacute;dure WinProc.<br \>
<br \>
Lorsque le syst&egrave;me d'exploitation Windows est en cours d'ex&eacute;cution, il y a tout le temps des messages g&eacute;n&eacute;r&eacute;s. Quand un programme Windows est en cours d'ex&eacute;cution, le syst&egrave;me d'exploitation envoie des messages au programme, lorsque quelque chose survient et que le syst&egrave;me d'exploitation pense que le programme devrait conna&icirc;tre. Certains de ces messages sp&eacute;cifiques du programme sont envoy&eacute;s directement &agrave; la proc&eacute;dure WinProc (ou similaire), et d'autres, principalement g&eacute;n&eacute;r&eacute;s par les utilisateurs des messages, sont plac&eacute;s dans une file de messages. Comme la plus grande partie d'un programme est concern&eacute;e par l'interaction avec l'utilisateur, il est important de comprendre la file de messages.<br \>
<br \>
Une file d'attente est une structure de donn&eacute;es o&ugrave; les donn&eacute;es sont ajout&eacute;es &agrave; l'arri&egrave;re de la file d'attente et retir&eacute;es de l'avant. C'est ce qu'on appelle une pile "First In-First-Out", ou FIFO (premier dedans - premier dehors. Si vous avez d&eacute;j&agrave; fait la queue pour acheter des billets de cin&eacute;ma, vous avez connu une file d'attente.<br \>
<br \>
Pour un programme, la file de messages contiendra un ou plusieurs messages, align&eacute;s comme les gens en ligne dans une file pour l'achat d'un billet de cin&eacute;ma. La boucle de veille d'un programme Windows attend l'arriv&eacute;e de messages puis les traduit et les distribue au programme. Cette boucle de messages est contenu dans l'extrait de code suivant de WinMain.<br \>
<br \>
<tt><tt><div class="FreeBASIC">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''&nbsp;Process&nbsp;windows&nbsp;messages</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="com">''</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">While</span><span class="oth">(</span>&nbsp;<span class="wrd">GetMessage</span><span class="oth">(</span>&nbsp;<span class="oth">@</span><span class="wrd">wMsg</span><span class="oth">,</span>&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="num">0</span><span class="oth">,</span>&nbsp;<span class="num">0</span>&nbsp;<span class="oth">)</span>&nbsp;<span class="oth">&lt;&gt;</span>&nbsp;<span class="wrd">FALSE</span>&nbsp;<span class="oth">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">TranslateMessage</span><span class="oth">(</span>&nbsp;<span class="oth">@</span><span class="wrd">wMsg</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">DispatchMessage</span><span class="oth">(</span>&nbsp;<span class="oth">@</span><span class="wrd">wMsg</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Wend</span><br />
</div></tt><br />
</tt><br \>
<br \>
La proc&eacute;dure <b>GetMessage</b> r&eacute;cup&egrave;re un message de la file d'attente via le param&egrave;tre <b>wMsg</b>. Le param&egrave;tre <b>wMsg</b> est un type de MSG-def qui contient les informations n&eacute;cessaires relatives &agrave; un message particulier. Voici la d&eacute;finition de la MSG de type def.<br \>
<br \>
<tt><tt><div class="FreeBASIC">
<span class="key">Type</span>&nbsp;<span class="wrd">MSG</span><br />
<span class="wrd">hwnd</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">HWND</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">message</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">UINT</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">wParam</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">WPARAM</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">lParam</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">LPARAM</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Time</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">DWORD</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">pt</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Point</span><br />
<span class="key">End</span>&nbsp;<span class="key">Type</span><br />
</div></tt><br />
</tt><br \>
<br \>
<b>hwnd</b> est l'identificateur de la fen&ecirc;tre qui doit traiter le message. Ce message sera trait&eacute; par la proc&eacute;dure WinProc de cette fen&ecirc;tre.<br \>
<br \>
<b>Message</b> est l'identificateur de message. Cela pourrait &ecirc;tre, par exemple, WM_CREATE, ce qui indique que la fen&ecirc;tre a &eacute;t&eacute; cr&eacute;&eacute;e, mais n'a pas encore &eacute;t&eacute; montr&eacute;e.<br \>
<br \>
<b>wParam</b> et <b>lParam</b> sp&eacute;cifient des informations suppl&eacute;mentaires sur la base du type de message. Par exemple, quand une touche est enfonc&eacute;e, vous pouvez r&eacute;cup&eacute;rer le code de la cl&eacute; en utilisant le "lobyte" de "wParam".<br \>
<br \>
<b>time</b> sp&eacute;cifie le moment o&ugrave; le message a &eacute;t&eacute; envoy&eacute; et <b>pt</b> est une structure qui contient la position du curseur lorsque le message a &eacute;t&eacute; envoy&eacute;.<br \>
<br \>
<b>TranslateMessage</b> convertit les messages virtuels vers des messages caract&egrave;res, et les met de nouveau dans la file d'attente afin que la cl&eacute; les traite si vous le souhaitez. Tout programme qui utilise le clavier aurez besoin de cette proc&eacute;dure. <b>DispatchMethod</b> envoie alors un message &agrave; la proc&eacute;dure WinProc (ou similaire) associ&eacute;e &agrave; la fen&ecirc;tre identifi&eacute;e par le param&egrave;tre <b>hWnd</b>.
<br \>
<br \>
Pour r&eacute;sumer les actions ici, un message g&eacute;n&eacute;r&eacute; par l'utilisateur sera plac&eacute; dans le "retour" de la file de messages. "GetMessage" r&eacute;cup&egrave;re le premier message d'attente, il le passe &agrave; "TranslateMessage" qui convertit le message si n&eacute;cessaire, et il le remet dans la file d'attente. Le message est ensuite transmis &agrave; "DispatchMessage", qui examine le message pour voir quelle fen&ecirc;tre devrait faire passer le message, puis passe le message sur la proc&eacute;dure de gestionnaire des fen&ecirc;tres, qui, dans notre exemple, est "WinProc".
<br \>
<br \>
Cependant, avant de discuter de la proc&eacute;dure WinProc, nous devons nous poser une question: Qu'est-ce qui se passe s'il y a plus d'une fen&ecirc;tre dans un programme? Comment WinMain sait-il quelle proc&eacute;dure utiliser? La r&eacute;ponse est contenue dans la structure WNDCLASS. Dans notre exemple, wcls est d&eacute;fini comme WNDCLASS dans la proc&eacute;dure WinMain.<br \>
<br \>
<tt><tt><div class="FreeBASIC">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">With</span>&nbsp;<span class="wrd">wcls</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">style</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">CS_HREDRAW</span>&nbsp;<span class="key">Or</span>&nbsp;<span class="wrd">CS_VREDRAW</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lpfnWndProc</span>&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="oth">@</span><span class="wrd">WndProc</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">cbClsExtra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">cbWndExtra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hInstance</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">hInstance</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hIcon</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">LoadIcon</span><span class="oth">(</span>&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="wrd">IDI_APPLICATION</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hCursor</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">LoadCursor</span><span class="oth">(</span>&nbsp;<span class="wrd">NULL</span><span class="oth">,</span>&nbsp;<span class="wrd">IDC_ARROW</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">hbrBackground</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">GetStockObject</span><span class="oth">(</span>&nbsp;<span class="wrd">WHITE_BRUSH</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lpszMenuName</span>&nbsp;&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">NULL</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="oth">.</span><span class="wrd">lpszClassName</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">StrPtr</span><span class="oth">(</span>&nbsp;<span class="wrd">szAppName</span>&nbsp;<span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">End</span>&nbsp;<span class="key">With</span><br />
</div></tt><br />
</tt><br \>
<br \>
Comme vous pouvez le voir, la structure WNDCLASS d&eacute;tient la totalit&eacute; des informations relatives &agrave; une fen&ecirc;tre particuli&egrave;re. En ce qui concerne les messages, l'&eacute;l&eacute;ment important est le champ <b>.lpfnWndProc</b>. Ce champ contient l'adresse de notre gestionnaire de messages pour cette fen&ecirc;tre. L'op&eacute;rateur @ dans FreeBasic renvoie l'adresse d'un objet, dans ce cas l'adresse de notre proc&eacute;dure "WinProc". Une fois cette fen&ecirc;tre enregistr&eacute;e en utilisant la m&eacute;thode "RegisterClass", Windows saura quelle est la proc&eacute;dure &agrave; utiliser pour traiter les messages.<br \>
<br \>
Comme vous pouvez le voir, il n'y a pas de signification particuli&egrave;re pour le nom de WinProc. WinProc pourrait &ecirc;tre appel&eacute; MyWinProc, ou WinHandler. Le nom r&eacute;el SDK est WindowProc, qui est juste un espace r&eacute;serv&eacute; pour le nom du gestionnaire un message d&eacute;fini par l'utilisateur. La pi&egrave;ce importante de l'information, c'est que ce que vous appelez, le gestionnaire de messages doit avoir les m&ecirc;mes param&egrave;tres que nous avons d&eacute;finis dans notre WinProc, et l'adresse de cette proc&eacute;dure doit &ecirc;tre stock&eacute;e dans <b>.lpfnWndProc</b>.<br \>
<br \>
Tous les messages, qu'ils soient g&eacute;n&eacute;r&eacute;s par l'utilisateur ou g&eacute;n&eacute;r&eacute;s par le syst&egrave;me passent &agrave; travers le gestionnaire de messages d&eacute;fini, qui dans notre exemple, est WinProc. En regardant la liste des param&egrave;tres de WinProc nous voyons que la plupart des composants de la structure du message sont r&eacute;cup&eacute;r&eacute;s par GetMessage. hwnd est le "handle" fen&ecirc;tre, "message" est l'identificateur du message, et wParam et lParam d&eacute;tiennent des informations message suppl&eacute;mentaires. Une fois qu'un message a &eacute;t&eacute; transmis &agrave; WinProc, nous devons alors d&eacute;cider si nous sommes int&eacute;ress&eacute;s par ce message.<br \>
<br \>
Cela se fait habituellement avec un "select case", o&ugrave; nous examinons le param&egrave;tre message pour voir si nous voulons le traiter. Par exemple, si le message est WM_PAINT, alors nous mettons notre code de dessin dans le cadre du message WM_PAINT afin que notre fen&ecirc;tre soit mise &agrave; jour chaque fois que la totalit&eacute; ou une partie de la fen&ecirc;tre est redessin&eacute;e. Si nous ne nous soucions pas d'un message, nous nous contentons de faire passer le message sur le message "DefWindowProc" pour &ecirc;tre trait&eacute; par le gestionnaire de messages par d&eacute;faut.<br \>
<br \>
L'action ici est assez simple. WinMain ou Windows nous envoie des messages, et nous r&eacute;pondons aux messages qui sont int&eacute;ressants. Quand les messages arrivent dans la file de messages, ils sont trait&eacute;s et envoy&eacute;s &agrave; WinProc, o&ugrave; ils peuvent &ecirc;tre trait&eacute;s ult&eacute;rieurement, et ensuite transmis &agrave; DefWindowProc pour &ecirc;tre trait&eacute;s par le syst&egrave;me d'exploitation. Cette boucle se poursuit pendant la dur&eacute;e de vie du programme, jusqu'&agrave; ce qu'&agrave; r&eacute;ception du message WM_QUIT, &agrave; ce moment-l&agrave; la fen&ecirc;tre est d&eacute;truite et le programme s'arr&ecirc;te.<br \>
<br \>
Dans notre exemple, le programme n'est concern&eacute; que par trois messages, WM_LBUTTONUP, WM_PAINT et WM_KEYDOWN. Le WM_CREATE et WM_DESTROY sont essentiellement r&eacute;utilisables pour trouver n'importe quelle fen&ecirc;tre programme. Puisque nous sommes seulement int&eacute;ress&eacute;s par ces trois messages, nous avons seulement besoin d'&eacute;crire du code pour ces trois messages. Le reste des messages que nous pourrions recevoir ne nous concernent pas, alors nous ne nous donnons pas la m&ecirc;me peine pour eux.<br \>
<br \>
Dans un langage bas&eacute; sur les messages, vous &eacute;crivez du code pour g&eacute;rer un &eacute;v&eacute;nement qui a eu lieu. Nous savons que l'&eacute;v&eacute;nement a eu lieu parce que nous avons re&ccedil;u un message d&eacute;crivant l'&eacute;v&eacute;nement. Si nous sommes int&eacute;ress&eacute;s, alors dans ce cas, nous &eacute;crivons du code pour y r&eacute;pondre. Au lieu d'&eacute;crire d'&eacute;normes quantit&eacute;s de code pour g&eacute;rer tous les aspects du programme comme nous devons le faire dans un langage proc&eacute;dural, nous avons seulement besoin d'&eacute;crire du code pour certains &eacute;v&eacute;nements, et on laisse le syst&egrave;me d'exploitation g&eacute;rer tout le reste<br \>
<br \>
Maintenant, bien s&ucirc;r, vous devez &eacute;crire du code pour cr&eacute;er une fen&ecirc;tre et des contr&ocirc;les, mais il s'agit surtout de code de type passe-partout. Vous suivez simplement l'API et transmettez les param&egrave;tres appropri&eacute;s &agrave; la fonction CreateWindow. Une fois que vous avez compris, c'est tout simplement une question de branchement ce code dans votre programme en cas de besoin. La v&eacute;ritable action se produit dans la fonction WinProc lorsque vous interagissez avec la fen&ecirc;tre ou les contr&ocirc;les.<br \>
<br \>
La programmation bas&eacute;e sur les messages n&eacute;cessite un autre &eacute;tat ​​d'esprit que la programmation proc&eacute;durale. Dans un langage proc&eacute;dural, l'utilisateur doit r&eacute;pondre au programme, le programmeur est en charge. Dans un programme graphique, le programme doit r&eacute;pondre &agrave; l'utilisateur et l'utilisateur est en charge. Pour &eacute;crire des programmes efficaces pour l'interface graphique, le programmeur doit abandonner le contr&ocirc;le sur le programme et travailler en coop&eacute;ration avec le syst&egrave;me d'exploitation et l'utilisateur.<br \>
<br \>
Lorsque vous concevez un programme graphique, vous devez vous demander, "Comment mon programme doit-il r&eacute;pondre &agrave; l'utilisateur?" Par exemple, lorsque l'application est r&eacute;duite, le programme doit-il ignorer l'&eacute;v&eacute;nement, ou faut-il faire quelque chose comme le placer dans la barre d'&eacute;tat syst&egrave;me? C'est l'essence m&ecirc;me de la programmation bas&eacute;e sur les messages. D&eacute;finir quels &eacute;v&eacute;nements sont importants et ensuite &eacute;crire des routines individuelles qui traitent chacun de ces &eacute;v&eacute;nement. Un programme bas&eacute; sur les messages est simplement une collection de routines sp&eacute;cifiques &eacute;crites en r&eacute;ponse &agrave; des messages sp&eacute;cifiques.<br \>
<br \>
Malgr&eacute; la r&eacute;putation du SDK, le concept de base de la programmation bas&eacute;e sur des messages est tr&egrave;s simple. Vous &eacute;crivez une collection de routines pour g&eacute;rer les messages. C'est la t&acirc;che essentielle. Toutes les autres choses comme la cr&eacute;ation d'une fen&ecirc;tre ou repeindre la fen&ecirc;tre sont ex&eacute;cut&eacute;es par le syst&egrave;me d'exploitation. C'est la port&eacute;e du SDK pour la plupart des personnes. Il y a beaucoup de choses int&eacute;ressantes &agrave; l'it&eacute;rieur. Cependant, comme le dit le clich&eacute;, la meilleure fa&ccedil;on de manger un &eacute;l&eacute;phant c'est bouch&eacute;e par bouch&eacute;e et en prenant du temps. La meilleure fa&ccedil;on de ma&icirc;triser le SDK est simplement de comprendre le concept de programmation bas&eacute;e sur les messages et d'apprendre le code r&eacute;utilisable. Une fois cela fait, la cr&eacute;ation de programmes Windows complexes n'est pas si difficile.<br \>

</div>
</div> 
</div> 
</body>
</html>
