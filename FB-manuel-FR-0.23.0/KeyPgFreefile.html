<html>
<head>
<title>FreeFile</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">FreeFile</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Retourne un num&eacute;ro de fichier libre<br \>
<br \>
<div class="fb_sect_title">Syntaxe</div><div class="fb_sect_cont"><tt><br \>
<a href="KeyPgDeclare.html">Declare</a> <a href="KeyPgFunction.html">Function</a> <b>FreeFile</b> ( ) <a href="KeyPgAs.html">As</a> <a href="KeyPgInteger.html">Integer</a><br \>
</tt><br \>
</div><div class="fb_sect_title">Usage</div><div class="fb_sect_cont"><tt><br \>
<i>result</i> = <b>FreeFile</b><br \>
</tt><br \>
</div><div class="fb_sect_title">Valeur retourn&eacute;e</div><div class="fb_sect_cont"><br \>
Le premier num&eacute;ro de fichier libre, s'il existe, sinon z&eacute;ro (<tt>0</tt>).<br \>
<br \>
</div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
Retourne le num&eacute;ro de fichier libre suivant avec des valeurs valides de <tt>1</tt> &agrave; <tt>255</tt>, ou <tt>0</tt> s'il y a d&eacute;j&agrave; 255 fichiers ouverts. Cette valeur est un argument obligatoire de <tt><a href="KeyPgOpen.html">Open</a></tt> un fichier. <tt><b>FreeFile</b></tt> est utile lors de l'ouverture de fichiers dans des programmes complexes o&ugrave; le programmeur ne peut pas garder une trace des num&eacute;ros de fichiers utilis&eacute;s.<br \>
<br \>
Assurez-vous de toujours fermer les fichiers lorsqu'ils ne sont plus n&eacute;cessaires, sinon vous aurez une perte de num&eacute;ros de fichiers, et vous ne serez pas en mesure d'ouvrir des fichiers d&egrave;s que 255 num&eacute;ros de fichiers seront utilis&eacute;s pendant le fonctionnement de votre programme.<br \>
<br \>
<tt><b>FreeFile</b></tt> retourne toujours le num&eacute;ro de fichier libre le plus prtit possible. Le num&eacute;ro de fichier retourn&eacute; par <tt><b>FreeFile</b></tt> ne changera pas tant que le fichier correspondant reste <tt><a href="KeyPgOpen.html">ouvert  (Open)</a></tt>, ou jusqu'&agrave; ce qu'un fichier de num&eacute;ros de fichier plus petit soit <tt><a href="KeyPgClose.html">ferm&eacute; (Close)</a></tt>. Pour cette raison, il est sage d'utiliser <tt><b> FreeFile</b></tt>, imm&eacute;diatement avant son <tt><a href="KeyPgOpen.html">Open</a></tt> correspondant, afin de s'assurer que le num&eacute;ro de fichier retourn&eacute; n'a pas &eacute;t&eacute; ouvert ailleurs en premier.
<br \>
</div><div class="fb_sect_title">Exemple</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="com">'&nbsp;Create&nbsp;a&nbsp;string&nbsp;and&nbsp;fill&nbsp;it.</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">buffer</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><span class="oth">,</span>&nbsp;<span class="wrd">f</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<span class="wrd">buffer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="quo">"Hello&nbsp;World&nbsp;within&nbsp;a&nbsp;file."</span><br />
<br />
<span class="com">'&nbsp;Find&nbsp;the&nbsp;first&nbsp;free&nbsp;file&nbsp;number.</span><br />
<span class="wrd">f</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">FreeFile</span><br />
<br />
<span class="com">'&nbsp;Open&nbsp;the&nbsp;file&nbsp;"file.ext"&nbsp;for&nbsp;binary&nbsp;usage,&nbsp;using&nbsp;the&nbsp;file&nbsp;number&nbsp;"f".</span><br />
<span class="key">Open</span>&nbsp;<span class="quo">"file.ext"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Binary</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">f</span><br />
<br />
<span class="com">'&nbsp;Place&nbsp;our&nbsp;string&nbsp;inside&nbsp;the&nbsp;file,&nbsp;using&nbsp;file&nbsp;number&nbsp;"f".</span><br />
<span class="key">Put</span>&nbsp;<span class="oth">#</span><span class="wrd">f</span><span class="oth">,</span>&nbsp;<span class="oth">,</span>&nbsp;<span class="wrd">buffer</span><br />
<br />
<span class="com">'&nbsp;Close&nbsp;the&nbsp;file.</span><br />
<span class="key">Close</span>&nbsp;<span class="oth">#</span><span class="wrd">f</span><br />
<br />
<span class="com">'&nbsp;End&nbsp;the&nbsp;program.&nbsp;(Check&nbsp;the&nbsp;file&nbsp;"file.ext"&nbsp;upon&nbsp;running&nbsp;to&nbsp;see&nbsp;the&nbsp;output.)</span><br />
<span class="key">End</span><br />
</div></tt><br />
<br \>
Lors de l'ouverture de plusieurs <tt><b>FreeFile</b></tt>, <tt><b>FreeFile</b></tt> doit &ecirc;tre utilis&eacute; imm&eacute;diatement avant <tt><a href="KeyPgOpen.html">Open</a></tt>:<br \>
<tt><div class="freebasic">
<span class="key">Dim</span>&nbsp;<span class="wrd">fr</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">fs</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<span class="com">'&nbsp;The&nbsp;CORRECT&nbsp;WAY:</span><br />
<span class="wrd">fr</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">FreeFile</span><br />
<span class="key">Open</span>&nbsp;<span class="quo">"File1"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Input</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">fr</span><br />
<br />
<span class="wrd">fs</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">FreeFile</span><br />
<span class="key">Open</span>&nbsp;<span class="quo">"File2"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Input</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">fs</span><br />
</div></tt><br />
<br />
Par opposition &agrave;:<br \>
<tt><div class="freebasic">
<span class="key">Dim</span>&nbsp;<span class="wrd">fr</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">,</span>&nbsp;<span class="wrd">fs</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
&nbsp;<span class="com">'&nbsp;The&nbsp;WRONG&nbsp;way:</span><br />
<span class="key">Open</span>&nbsp;<span class="quo">"file1"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Input</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">fr</span><br />
<span class="key">Open</span>&nbsp;<span class="quo">"file2"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Input</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">fs</span>&nbsp;<span class="com">''&nbsp;error:&nbsp;file&nbsp;number&nbsp;already&nbsp;opened</span><br />
<br />
<span class="key">Open</span>&nbsp;<span class="quo">"file1"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Input</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">fr</span><br />
<span class="key">Open</span>&nbsp;<span class="quo">"file2"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Input</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="wrd">fs</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Diff&eacute;rences de plate-forme</div><div class="fb_sect_cont"><br \>
<ul><li> Sous Windows, un num&eacute;ro de fichier utilis&eacute; dans une biblioth&egrave;que de liens dynamiques n'est pas identique &agrave; celui utilis&eacute; dans le programme principal.  Les num&eacute;ros de fichier ne peuvent &ecirc;tre pass&eacute;s ou renvoy&eacute;s, puis utilis&eacute;s entre une DLL et un fichier ex&eacute;cutable.<br \>
<li> Outre la limite FreeBASIC de 255 fichiers ouverts en m&ecirc;me temps par le programme, il y a une limite OS du nombre total de fichiers ouverts, mais g&eacute;n&eacute;ralement vous n'aurez pas le modifier, sauf dans le DOS, o&ugrave; la limite peut &ecirc;tre tr&egrave;s basse (15 fichiers au total).<br \>
<br \>
</ul></div><div class="fb_sect_title">Diff&eacute;rences avec QB</div><div class="fb_sect_cont"><br \>
<ul><li> Aucune<br \>
<br \>
</ul></div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgOpen.html">Open</a></tt><br \>
<li> <tt><a href="KeyPgPutfileio.html">Put (File I/O)</a></tt><br \>
<li> <tt><a href="KeyPgGetfileio.html">Get (File I/O)</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
