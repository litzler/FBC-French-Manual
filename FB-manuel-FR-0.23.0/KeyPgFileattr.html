<html>
<head>
<title>FileAttr</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">FileAttr</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Retourne des informations sur un num&eacute;ro de fichier ouvert<br \>
<br \>
<div class="fb_sect_title">Syntaxe</div><div class="fb_sect_cont"><tt><br \>
<a href="KeyPgDeclare.html">Declare</a> <a href="KeyPgFunction.html">Function</a> <b>FileAttr</b> ( <a href="KeyPgByval.html">ByVal</a> <i>filenum</i> <a href="KeyPgAs.html">As</a> <a href="KeyPgInteger.html">Integer</a>, <a href="KeyPgByval.html">ByVal</a> <i>returntype</i> <a href="KeyPgAs.html">As</a> <a href="KeyPgInteger.html">Integer</a> = 1 ) <a href="KeyPgAs.html">As</a> <a href="KeyPgInteger.html">Integer</a><br \>
</tt><br \>
</div><div class="fb_sect_title">Usage</div><div class="fb_sect_cont"><tt><br \>
#include "file.bi"<br \>
<i>result</i> = <b>FileAttr</b>( <i>filenum</i>, [ <i>returntype</i> ] )<br \>
</tt><br \>
<i>ou</i><br \>
<tt><br \>
#include "vbcompat.bi"<br \>
<i>result</i> = <b>FileAttr</b>( <i>filenum</i>, [ <i>returntype</i> ] )<br \>
</tt><br \>
</div><div class="fb_sect_title">Param&egrave;tres</div><div class="fb_sect_cont"><br \>
<tt><i>filenum</i></tt><br \>
<div class="fb_indent">Le num&eacute;ro de fichier ou p&eacute;riph&eacute;rique ouvert avec <tt><a href="KeyPgOpen.html">Open</a></tt><br \>
</div><tt><i>returntype</i></tt><br \>
<div class="fb_indent">Un nombre <tt><a href="KeyPgInteger.html">Integer (Entier)</a></tt> indiquant le type d'information &agrave; renvoyer.<br \>
<br \>
</div></div><div class="fb_sect_title">Valeur retourn&eacute;e</div><div class="fb_sect_cont"><br \>
Une valeur associ&eacute;e au type de retour, sinon 0 en cas d'erreur.<br \>
<br \>
</div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
Information sur le num&eacute;ro de fichier est retourn&eacute; sur la base du <tt><i>returntype</i></tt> fourni<br \>
<div class="fb_indent"><div class="fb_table"><table><tr><td>Valeur</td><td>Description</td><td>constante</td></tr><tr><td>1</td><td>File Mode</td><td>fbFileAttrMode</td></tr><tr><td>2</td><td>File Handle</td><td>fbFileAttrHandle</td></tr><tr><td>3</td><td>Encoding</td><td>fbFileAttrEncoding</td></tr></table></div><br \>
<br \>
</div>Pour "File Mode", <tt><i>returntype</i></tt> = 1 (<tt>fbFileAttrMode</tt>) la valeur retourn&eacute;e est la somme d'une ou plusieurs des valeurs suivantes: <br \>
<div class="fb_indent"><div class="fb_table"><table><tr><td>Valeur</td><td>Mode fichier</td><td>Constante</td></tr><tr><td>1</td><td>Input</td><td>fbFileModeInput</td></tr><tr><td>2</td><td>Output</td><td>fbFileModeOutput</td></tr><tr><td>4</td><td>Random</td><td>fbFileModeRandom</td></tr><tr><td>8</td><td>Append</td><td>fbFileModeAppend</td></tr><tr><td>32</td><td>Binary</td><td>fbFileModeBinary</td></tr></table></div><br \>
<br \>
</div>Pour "File Handle", <tt><i>returntype</i></tt> = 2 (<tt>fbFileAttrHandle</tt>), la valeur de retour est le descripteur de fichier fourni par le "C Runtime" pour les dispositifs de type de fichier.  <br \>
<br \>
Sous Windows seulement: Pour "File Handle", <tt><i>returntype</i></tt> = 2 (<tt>fbFileAttrHandle</tt>), la valeur retourn&eacute;e pour les p&eacute;riph&eacute;riques COM est le "handle" retourn&eacute; par <tt>CreateFile()</tt> quand le p&eacute;riph&eacute;rique a &eacute;t&eacute; ouvert.  La valeur retourn&eacute;e pour les p&eacute;riph&eacute;riques LPT est le "handle" retourn&eacute; par <tt>OpenPrinter()</tt> quand le p&eacute;riph&eacute;rique a &eacute;t&eacute; ouvert.  Cette valeur "handle" peut être transmise &agrave; d'autres fonctions API de Windows.<br \>
<br \>
Sous Linux seulement: Pour "File Handle", <tt><i>returntype</i></tt> = 2 (<tt>fbFileAttrHandle</tt>), la valeur retourn&eacute;e pour les p&eacute;riph&eacute;riques COM est le descripteur de fichier retourn&eacute; par open() quand le p&eacute;riph&eacute;rique a &eacute;t&eacute; ouvert.<br \>
<br \>
Pour Encoding, <tt><i>returntype</i></tt> = 3 (<tt>fbFileAttrEncoding</tt>), la valeur de retour est l'une des valeurs suivantes:<br \>
<div class="fb_indent"><div class="fb_table"><table><tr><td>Valeur</td><td>Encoding</td><td>Constante</td></tr><tr><td>0</td><td>Ascii</td><td>fbFileEncodASCII</td></tr><tr><td>1</td><td>UTF-8</td><td>fbFileEncodUTF8</td></tr><tr><td>2</td><td>UTF-16</td><td>fbFileEncodUTF16</td></tr><tr><td>3</td><td>UTF-32</td><td>fbFileEncodUTF32</td></tr></table></div><br \>
<br \>
</div></div><div class="fb_sect_title">Exemple</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="def">#include&nbsp;"vbcompat.bi"<br />
#include&nbsp;"crt.bi"<br />
</span><br />
<span class="key">Dim</span>&nbsp;<span class="wrd">f</span>&nbsp;<span class="key">As</span>&nbsp;<span class="wrd">FILE</span>&nbsp;<span class="key">Ptr</span><span class="oth">,</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><br />
<br />
<span class="com">''&nbsp;Open&nbsp;a&nbsp;file&nbsp;and&nbsp;write&nbsp;some&nbsp;text&nbsp;to&nbsp;it</span><br />
<br />
<span class="key">Open</span>&nbsp;<span class="quo">"test.txt"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Output</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="num">1</span><br />
<span class="wrd">f</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Cast</span><span class="oth">(</span>&nbsp;<span class="wrd">FILE</span>&nbsp;<span class="key">Ptr</span><span class="oth">,</span>&nbsp;<span class="key">FileAttr</span><span class="oth">(</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="wrd">fbFileAttrHandle</span>&nbsp;<span class="oth">))</span><br />
<span class="key">For</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">1</span>&nbsp;<span class="key">To</span>&nbsp;<span class="num">10</span><br />
&nbsp;&nbsp;<span class="wrd">fprintf</span><span class="oth">(</span>&nbsp;<span class="wrd">f</span><span class="oth">,</span>&nbsp;<span class="oth">!</span><span class="quo">"Line&nbsp;%i\n"</span><span class="oth">,</span>&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">)</span><br />
<span class="key">Next</span>&nbsp;<span class="wrd">i</span><br />
<span class="key">Close</span>&nbsp;<span class="oth">#</span><span class="num">1</span><br />
<br />
<span class="com">''&nbsp;re-open&nbsp;the&nbsp;file&nbsp;and&nbsp;read&nbsp;the&nbsp;text&nbsp;back</span><br />
<br />
<span class="key">Open</span>&nbsp;<span class="quo">"test.txt"</span>&nbsp;<span class="key">For</span>&nbsp;<span class="key">Input</span>&nbsp;<span class="key">As</span>&nbsp;<span class="oth">#</span><span class="num">1</span><br />
<span class="wrd">f</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="key">Cast</span><span class="oth">(</span>&nbsp;<span class="wrd">FILE</span>&nbsp;<span class="key">Ptr</span><span class="oth">,</span>&nbsp;<span class="key">FileAttr</span><span class="oth">(</span>&nbsp;<span class="num">1</span><span class="oth">,</span>&nbsp;<span class="wrd">fbFileAttrHandle</span>&nbsp;<span class="oth">))</span><br />
<span class="key">While</span>&nbsp;<span class="wrd">feof</span><span class="oth">(</span><span class="wrd">f</span><span class="oth">)</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">0</span><br />
&nbsp;&nbsp;<span class="wrd">i</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="wrd">fgetc</span><span class="oth">(</span><span class="wrd">f</span><span class="oth">)</span><br />
&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="key">Chr</span><span class="oth">(</span><span class="wrd">i</span><span class="oth">);</span><br />
<span class="key">Wend</span><br />
<span class="key">Close</span>&nbsp;<span class="oth">#</span><span class="num">1</span><br />
</div></tt><br />
<br \>
</div><div class="fb_sect_title">Diff&eacute;rences avec QB</div><div class="fb_sect_cont"><br \>
<ul><li> Aucune pour <tt><i>returntype</i></tt> = 1<br \>
<li> QBasic et Visual Basic 16-bit retourne le "handle" fichier DOS pour <tt><i>returntype</i></tt> = 2<br \>
<li> <tt><i>returntype</i></tt> = 3 nouveau pour FreeBASIC<br \>
<br \>
</ul></div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<ul><li> <tt><a href="KeyPgOpen.html">Open</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
