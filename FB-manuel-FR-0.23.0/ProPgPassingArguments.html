<html>
<head>
<title>Passing Arguments to Procedures</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Passage d'arguments aux proc&eacute;dures</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Transmettre des informations &agrave; des proc&eacute;dures.<br \>
<br \>
<div class="fb_sect_title">D&eacute;clarer des param&egrave;tres</div><div class="fb_sect_cont"><br \>
On peut passer des informations sous forme de variables et d'objets, aux proc&eacute;dures lorsqu'elles sont appel&eacute;es. Dans le cadre d'un appel de proc&eacute;dure, ces variables et d'objets sont appel&eacute;es arguments. Ces arguments sont alors repr&eacute;sent&eacute;s en tant que param&egrave;tres &agrave; l'int&eacute;rieur du corps de proc&eacute;dure. Les param&egrave;tres peuvent &ecirc;tre utilis&eacute;e comme n'importe quelle autre variable ou objet.<br \>
<br \>
Pour sp&eacute;cifier qu'une proc&eacute;dure devrait passer des arguments lorsqu'on l'appelle, il faut d&eacute;clarer la proc&eacute;dure avec une liste de param&egrave;tres. Une liste de param&egrave;tres est une liste d'un ou plusieurs noms et types que la proc&eacute;dure utilisera lorsqu'elle se r&eacute;f&egrave;rera aux arguments qui lui sont pass&eacute;s. Les listes de param&egrave;tres sont entour&eacute;es de parenth&egrave;ses.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">Procedure</span>&nbsp;<span class="oth">(</span><span class="wrd">s</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">String</span><span class="oth">,</span>&nbsp;<span class="wrd">n</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;parameters&nbsp;have&nbsp;the&nbsp;values:&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">s</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="quo">"&nbsp;and&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">n</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="wrd">Procedure</span>&nbsp;<span class="quo">"abc"</span><span class="oth">,</span>&nbsp;<span class="num">123</span><br />
</div></tt><br />
produira le r&eacute;sultat suivant:<br \>
<br \>
<pre class="fb_pre">The parameters have the values: abc and 123</pre>
Il y a deux fa&ccedil;ons de passer des arguments aux proc&eacute;dures: par valeur et par r&eacute;f&eacute;rence. Par d&eacute;faut, les arguments sont pass&eacute;s par valeur, sauf indication contraire.<br \>
<br \>
</div><div class="fb_sect_title">Passage d'arguments par valeur</div><div class="fb_sect_cont"><br \>
Les arguments qui sont pass&eacute;s par valeur ne sont pas r&eacute;ellement pass&eacute;s aux proc&eacute;dures; au lieu de cela une copie de l'argument est faite et pass&eacute;e. Cela permet &agrave; la proc&eacute;dure de modifier la copie et la variable ou l'objet d'origine restent inchang&eacute;s.<br \>
<br \>
Lors du passage d'objets aux proc&eacute;dures par valeur, la copie est faite en appelant le constructeur de copie du <tt><a href="KeyPgType.html">Type</a></tt> ou de la <tt><a href="KeyPgClass.html">Class</a></tt>.<br \>
<br \>
Pour sp&eacute;cifier qu'un argument doit &ecirc;tre pass&eacute; par valeur, faire pr&eacute;c&eacute;der le nom du param&egrave;tre de la d&eacute;claration de proc&eacute;dure du mot-cl&eacute; <tt><a href="KeyPgByval.html">ByVal</a></tt>:<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">Procedure</span>&nbsp;<span class="oth">(</span><span class="key">ByVal</span>&nbsp;<span class="wrd">param</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">param</span>&nbsp;<span class="oth">*=</span>&nbsp;<span class="num">2</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;parameter&nbsp;'param'&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">param</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">arg</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">10</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;variable&nbsp;'arg'&nbsp;before&nbsp;the&nbsp;call&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
<span class="wrd">Procedure</span><span class="oth">(</span><span class="wrd">arg</span><span class="oth">)</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;variable&nbsp;'arg'&nbsp;after&nbsp;the&nbsp;call&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
</div></tt><br />
produira le r&eacute;sultat suivant:<br \>
<br \>
<pre class="fb_pre">
The variable 'arg' before the call = 10
The parameter 'param' = 20
The variable 'arg' after the call = 10
</pre>Remarquez comment les parenth&egrave;ses entourent les arguments - dans ce cas, un seul, <tt><i>arg</i></tt> - dans l'appel de proc&eacute;dure. Ces parenth&egrave;ses sont facultatives, mais sont une convention commune pour signifier un appel de proc&eacute;dure.<br \>
<br \>
</div><div class="fb_sect_title">Passage d'arguments par r&eacute;f&eacute;rence</div><div class="fb_sect_cont"><br \>
Contrairement aux arguments qui sont pass&eacute;s par valeur, les arguments qui sont pass&eacute;s aux proc&eacute;dures par r&eacute;f&eacute;rence sont vraiment pass&eacute;s; aucune copie n'est faite. Cela permet &agrave; la proc&eacute;dure de modifier la variable ou objet d'origine qui lui a &eacute;t&eacute; pass&eacute;.<br \>
<br \>
Une r&eacute;f&eacute;rence est comme un alias pour une variable ou un objet. Chaque fois que vous faites appel &agrave; une r&eacute;f&eacute;rence, vous faites allusion &agrave; la variable ou &agrave; l'objet r&eacute;el(le) dont elle est l'alias. En d'autres termes, vous pouvez imaginer une r&eacute;f&eacute;rence &agrave; un param&egrave;tre d'une proc&eacute;dure comme &eacute;tant l'argument qui lui est pass&eacute;; les modifications apport&eacute;es &agrave; la r&eacute;f&eacute;rence du param&egrave;tre sont en fait des changements &agrave; l'argument qu'il repr&eacute;sente.<br \>
<br \>
Pour sp&eacute;cifier qu'un argument doit &ecirc;tre pass&eacute; par r&eacute;f&eacute;rence, faire pr&eacute;c&eacute;der le nom du param&egrave;tre dans la d&eacute;claration de proc&eacute;dure avec le mot-cl&eacute; <tt><a href="KeyPgByref.html">ByRef</a></tt>:<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Sub</span>&nbsp;<span class="wrd">Procedure</span>&nbsp;<span class="oth">(</span><span class="key">ByRef</span>&nbsp;<span class="wrd">param</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span><span class="oth">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="wrd">param</span>&nbsp;<span class="oth">*=</span>&nbsp;<span class="num">2</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;parameter&nbsp;'param'&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">param</span><br />
<span class="key">End</span>&nbsp;<span class="key">Sub</span><br />
<br />
<span class="key">Dim</span>&nbsp;<span class="wrd">arg</span>&nbsp;<span class="key">As</span>&nbsp;<span class="key">Integer</span>&nbsp;<span class="oth">=</span>&nbsp;<span class="num">10</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;variable&nbsp;'arg'&nbsp;before&nbsp;the&nbsp;call&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
<span class="wrd">Procedure</span><span class="oth">(</span><span class="wrd">arg</span><span class="oth">)</span><br />
<span class="key">Print</span>&nbsp;<span class="quo">"The&nbsp;variable&nbsp;'arg'&nbsp;after&nbsp;the&nbsp;call&nbsp;=&nbsp;"</span>&nbsp;<span class="oth">&amp;</span>&nbsp;<span class="wrd">arg</span><br />
</div></tt><br />
produira le r&eacute;sultat suivant::<br \>
<br \>
<pre class="fb_pre">
The variable 'arg' before the call = 10
The parameter 'param' = 20
The variable 'arg' after the call = 20
</pre><br \>
</div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<ul><li> <a href="ProPgProcedures.html">Vue d'ensemble des proc&eacute;dures</a><br \>
<li> <a href="ProPgReturnValue.html">Retourner une valeur</a><br \>
<li> <tt><a href="KeyPgDeclare.html">Declare</a></tt><br \>
<li> <tt><a href="KeyPgSub.html">Sub</a></tt><br \>
<li> <tt><a href="KeyPgFunction.html">Function</a></tt><br \>
<li> <tt><a href="KeyPgByval.html">ByVal</a></tt><br \>
<li> <tt><a href="KeyPgByref.html">ByRef</a></tt><br \>
<br \>
</ul></div>
</div>
</div> 
</div> 
</body>
</html>
