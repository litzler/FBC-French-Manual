<html>
<head>
<title>Open Com</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="fb_body_wrapper">
<div id="fb_tab">
<div id="fb_tab_l">Open Com</div>
<div id="fb_tab_r">&nbsp;<img src="images/fblogo_mini.gif" /></div> 
</div> 
<div id="fb_pg_wrapper">
<div id="fb_pg_body">
	Ouvre un port s&eacute;rie en entr&eacute;e et sortie<br \>
<br \>
<div class="fb_sect_title">Syntaxe</div><div class="fb_sect_cont"><tt><br \>
<a href="KeyPgDeclare.html">Declare</a> <a href="KeyPgFunction.html">Function</a> <b>Open Com</b> ( byref <i>options</i> <a href="KeyPgAs.html">As</a> <a href="KeyPgString.html">String</a>, <b>As</b> <i>filenum</i> <a href="KeyPgAs.html">As</a> <a href="KeyPgInteger.html">Integer</a> ) <a href="KeyPgAs.html">As</a> <a href="KeyPgInteger.html">Integer</a><br \>
</tt><br \>
</div><div class="fb_sect_title">Usage</div><div class="fb_sect_cont"><tt><br \>
<i>result</i> = <b>Open Com</b>( <i>options</i>, <b>As</b>[#] <i>filenum</i> )<br \>
</tt><br \>
</div><div class="fb_sect_title">Param&egrave;tres</div><div class="fb_sect_cont"><br \>
<tt><i>options</i></tt><br \>
<div class="fb_indent">A <a href="KeyPgString.html">String</a> contenant les options de contr&ocirc;le du port.<br \>
</div><tt><i>filenum</i></tt><br \>
<div class="fb_indent">Le num&eacute;ro de fichier &agrave; associer au port.<br \>
<br \>
</div></div><div class="fb_sect_title">Valeur retourn&eacute;e</div><div class="fb_sect_cont"><br \>
Retourne z&eacute;ro (0) si succ&egrave;s et autrement un code d'erreur diff&eacute;rent de z&eacute;ro.<br \>
<br \>
</div><div class="fb_sect_title">Description</div><div class="fb_sect_cont"><br \>
Cette commande ouvre un port s&eacute;rie du PC, ce qui permet d'envoyer et de recevoir des donn&eacute;es en utilisant les commandes de fichiers normales comme PRINT #, INPUT #, GET #,...<br \>
<br \>
Le param&egrave;tre principal est une <a href="KeyPgString.html">String</a> qui d&eacute;crit, &agrave; tout le moins, le port de communication &agrave; ouvrir. Elle a le format:<br \>
<br \>
<div class="fb_indent"><tt>"<b>Com</b><i>n</i><b>:</b> [ <i>baudrate</i> ][ , [ <i>parity</i> ][ , [ <i>data_bits</i> ][ , [ <i>stop_bits</i> ][ , [ <i>extended_options</i> ]]]]]"</tt><br \>
<br \>
</div>o&ugrave;,<br \>
<tt><i>n</i></tt><br \>
<div class="fb_indent">Port Com &agrave; ouvrir. "1", "2", "3", "4", etc.  Certaines plates-formes ont plus de ports s&eacute;rie selon la fa&ccedil;on dont le syst&egrave;me d'exploitation est configur&eacute;.  Si <tt><i>n</i></tt> est absent, "COM:" sera "COM1:", sauf sous Linux o&ugrave; "COM:" sera "/dev/modem"<br \>
</div><tt><i>baudrate</i></tt><br \>
<div class="fb_indent">"300" (par d&eacute;faut), "1200", ..., etc.<br \>
</div><tt><i>parity</i></tt><br \>
<div class="fb_indent">"N" (none=aucune), "E" (even=paire, par d&eacute;faut), "O" (odd=impaire), "S" (space=espace), "M" (mark=marque), "PE" (QB-quirk: checked, even parity)<br \>
</div><tt><i>data_bits</i></tt><br \>
<div class="fb_indent">"5", "6", "7" (par d&eacute;faut) or "8".<br \>
</div><tt><i>stop_bits</i></tt><br \>
<div class="fb_indent">"1", "1.5" or "2". <i>(la valeur par d&eacute;faut d&eacute;pend de "baud rate" et "data bits", voir table ci-dessous)</i><br \>
<br \>
<div class="fb_indent"><div class="fb_table"><table><tr><td>Condition</td><td>Nombre de bits d'arr&ecirc;t par d&eacute;faut</td></tr><tr><td>baud rate &lt;= 110 et data bits = 5</td><td>1.5</td></tr><tr><td>baud rate &lt;= 110 et data bits &gt;= 6</td><td>2</td></tr><tr><td>baud rate &gt; 110</td><td>1</td></tr></table></div><br \>
</div></div><tt><i>extended_options</i></tt><br \>
<div class="fb_indent">Options diverses. <i>(Voir table ci-dessous)</i><br \>
<br \>
<div class="fb_indent"><div class="fb_table"><table><tr><td>Option</td><td>Action</td></tr><tr><td>'CSn'</td><td>&Eacute;tablit la dur&eacute;e de CTS (en ms) (n&gt;=0), 0 = arr&ecirc;ter, par d&eacute;faut = 1000</td></tr><tr><td>'DSn'</td><td>&Eacute;tablit la dur&eacute;e de DSR (en ms) (n&gt;=0), 0 = arr&ecirc;ter, par d&eacute;faut = 1000</td></tr><tr><td>'CDn'</td><td>&Eacute;tablit la dur&eacute;e de Carrier Detect (en ms) (n&gt;=0), 0 = arr&ecirc;ter</td></tr><tr><td>'OPn'</td><td>&Eacute;tablit 'Open Timeout' (en ms) (n&gt;=0), 0 = arr&ecirc;ter</td></tr><tr><td>'TBn'</td><td>&Eacute;tablit la taille de 'Transmit Buffer' (n&gt;=0), 0 = par d&eacute;faut, d&eacute;pend de la plate-forme </td></tr><tr><td>'RBn'</td><td>&Eacute;tablit la taille de 'Receive Buffer' (n&gt;=0), 0 = par d&eacute;faut, d&eacute;pend de la plate-forme</td></tr><tr><td>'RS'</td><td>Supprime la d&eacute;tection de RTS</td></tr><tr><td>'LF'</td><td>Communique en mode ASCII (ajoute LF &agrave; chaque CR) - Win32 ne permet pas</td></tr><tr><td>'ASC'</td><td>comme 'LF'</td></tr><tr><td>'BIN'</td><td>L'oppos&eacute; de LF et fonctionnera toujours</td></tr><tr><td>'PE'</td><td>Valide recherche de 'Parity'</td></tr><tr><td>'DT'</td><td>Conserve DTR valide apr&egrave;s CLOSE</td></tr><tr><td>'FE'</td><td>Rejeter caract&egrave;re non valide en cas d'erreur</td></tr><tr><td>'ME'</td><td>Ignorer toutes les erreurs</td></tr><tr><td>'IRn'</td><td>num&eacute;ro d'IRQ pour COM (support&eacute; seulement (?) sous DOS)</td></tr></table></div><br \>
<br \>
</div></div>Tous les items sont facultatifs, sauf pour le port COM. L'ordre de <tt><i>baudrate</i></tt>, <tt><i>parity</i></tt>, <tt><i>data_bits</i></tt>, <tt><i>stop_bits</i></tt> est fix&eacute;. Tout &eacute;l&eacute;ment fixe saut&eacute; ( <tt><i>baudrate</i></tt>, etc...) doit &ecirc;tre vide.<br \>
<br \>
</div><div class="fb_sect_title">Exemple</div><div class="fb_sect_cont"><br \>
<tt><div class="freebasic">
<span class="key">Open</span>&nbsp;<span class="key">Com</span>&nbsp;<span class="quo">"COM1:9600,N,,2"</span>&nbsp;<span class="key">As</span>&nbsp;<span class="num">1</span><br />
</div></tt><br />
Ouvre COM1 avec 9600 baud, no parity, 7 data bits et 2 stop bits.<br \>
<br \>
<tt><div class="freebasic">
<span class="key">Open</span>&nbsp;<span class="key">Com</span>&nbsp;<span class="quo">"COM1:115200"</span>&nbsp;<span class="key">As</span>&nbsp;<span class="num">1</span><br />
</div></tt><br />
Ouvre COM1 avec 115200 baud, "even" parity, 7 data bits et 1 stop bits. <br \>
<br \>
</div><div class="fb_sect_title">Diff&eacute;rences de plates-formes</div><div class="fb_sect_cont"><br \>
<li> Sur les plates-formes Windows <tt>"COM:"</tt> est <tt>"COM1:"</tt><br \><br \>
<li> Sur les plates-formes Linux<br \>
<div class="fb_indent"><tt>"COM:"</tt> est <tt>"/dev/modem"</tt><br \>
<tt>"COM1:"</tt> est <tt>"/dev/ttyS0"</tt><br \>
<tt>"COM2:"</tt> est <tt>"/dev/ttyS1"</tt>, etc <br \>
<tt>"/dev/xyz:"</tt> est <tt>"/dev/xyz"</tt>, etc<br \><br \>
</div><li>Le pilote s&eacute;rie DOS est exp&eacute;rimental et peut acc&eacute;der aux ports COM 1 &agrave; 4 <br \>
<div class="fb_indent">Il utilise la base suivante I/O et IRQ par d&eacute;faut: <br \>
COM1 - &h3f8 - IRQ4 <br \>
COM2 - &h2f8 - IRQ3 <br \>
COM3 - &h3e8 - IRQ4 <br \>
COM4 - &h2e8 - IRQ3 <br \>
Depuis fbc-0.18.4, une alternative IRQ peut &ecirc;tre sp&eacute;cifi&eacute;e en utilisant l'option du "IRn" protocole o&ugrave; "n" va de 3 &agrave; 7.<br \>
&Aacute; l'heure actuelle pas pris en charge: IRQ sur le PIC esclave, base alternative adresses I / O, D&eacute;lais d'attente et la plupart des erreurs d&eacute;tect&eacute;es dans QB, contr&ocirc;le de flux mat&eacute;riel, FIFO.<br \>
<tt>"COM:"</tt> est <tt>"COM1:"</tt><br \>
</div></div><div class="fb_sect_title">Diff&eacute;rences de dialecte</div><div class="fb_sect_cont"><br \>
<li> dans le dialecte <i><a href="CompilerOptlang.html">-lang qb</a></i> l'ancienne syntaxe <tt>OPEN "COMx:...</tt> est admise. <br \>
<br \>
</div><div class="fb_sect_title">Diff&eacute;rences avec QB</div><div class="fb_sect_cont"><br \>
<li>Dans la syntaxe QB il y avait <tt>OPEN  "COMx:[baudrate] [,parity, [data_bits, [stop_bits, [extended_options]]]]"  FOR INPUT|OUTPUT|RANDOM AS [#] n</tt><br \>
<li> Dans QB, seulement <tt>"COM1:"</tt> et <tt>"COM2:"</tt> sont support&eacute;s.  Dans FreeBASIC, tout port s&eacute;rie correctement configur&eacute; peut &ecirc;tre utilis&eacute;.<br \>
<br \>
</div><div class="fb_sect_title">Voir aussi</div><div class="fb_sect_cont"><br \>
<li> <tt><a href="KeyPgOpen.html">Open</a></tt><br \>
<br \>
</div>
</div>
</div> 
</div> 
</body>
</html>
